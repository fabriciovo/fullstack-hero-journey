{"version":3,"sources":["../../src/models/PlayerModel.js"],"names":["PlayerModel","playerId","spawnLocations","players","name","key","actionB","playerSchema","attack","defense","health","maxHealth","gold","id","playerName","items","equipedItems","level","exp","maxExp","potions","maxNumberOfItems","actionAActive","potionAActive","flipX","location","generateLocation","x","y","item","attackBonus","defenseBonus","healthBonus","removeItem","itemId","Object","keys","length","damage","updateHealth","calcNewExp","Math","floor","random","invalidLocation","some"],"mappings":";;;;;;;;;;;;;IAAqBA,W;AACnB,uBAAYC,QAAZ,EAAsBC,cAAtB,EAAsCC,OAAtC,EAA+CC,IAA/C,EAAqDC,GAArD,EAA0DC,OAA1D,EAAmEC,YAAnE,EAAiF;AAAA;AAC/E,SAAKC,MAAL,GAAcD,YAAY,CAACC,MAA3B;AACA,SAAKC,OAAL,GAAeF,YAAY,CAACE,OAA5B;AACA,SAAKC,MAAL,GAAcH,YAAY,CAACG,MAA3B;AACA,SAAKC,SAAL,GAAiBJ,YAAY,CAACI,SAA9B;AACA,SAAKC,IAAL,GAAYL,YAAY,CAACK,IAAzB;AACA,SAAKC,EAAL,GAAUZ,QAAV;AACA,SAAKa,UAAL,GAAkBV,IAAlB;AACA,SAAKC,GAAL,GAAWA,GAAX;AACA,SAAKU,KAAL,GAAaR,YAAY,CAACQ,KAAb,IAAsB,EAAnC;AACA,SAAKC,YAAL,GAAoBT,YAAY,CAACS,YAAb,IAA6B,EAAjD;AACA,SAAKC,KAAL,GAAaV,YAAY,CAACU,KAA1B;AACA,SAAKC,GAAL,GAAWX,YAAY,CAACW,GAAxB;AACA,SAAKC,MAAL,GAAcZ,YAAY,CAACY,MAA3B;AACA,SAAKC,OAAL,GAAeb,YAAY,CAACa,OAA5B,CAd+E,CAe/E;;AAEA,SAAKC,gBAAL,GAAwB,CAAxB;AAEA,SAAKnB,cAAL,GAAsBA,cAAtB;AACA,SAAKoB,aAAL,GAAqB,KAArB;AACA,SAAKC,aAAL,GAAqB,KAArB;AACA,SAAKC,KAAL,GAAa,IAAb;AACA,QAAMC,QAAQ,GAAG,KAAKC,gBAAL,CAAsBvB,OAAtB,CAAjB;AACA,SAAKwB,CAAL,GAASF,QAAQ,CAAC,CAAD,CAAjB;AACA,SAAKG,CAAL,GAASH,QAAQ,CAAC,CAAD,CAAjB;AACD;;;;WAED,iBAAQI,IAAR,EAAc;AACZ,WAAKd,KAAL,CAAWc,IAAI,CAAChB,EAAhB,IAAsBgB,IAAtB;AACD;;;WAED,mBAAUA,IAAV,EAAgB;AACd,WAAKb,YAAL,CAAkBa,IAAI,CAAChB,EAAvB,IAA6BgB,IAA7B;AAEA,WAAKrB,MAAL,IAAe,KAAKQ,YAAL,CAAkBa,IAAI,CAAChB,EAAvB,EAA2BiB,WAA1C;AACA,WAAKrB,OAAL,IAAgB,KAAKO,YAAL,CAAkBa,IAAI,CAAChB,EAAvB,EAA2BkB,YAA3C;AACA,WAAKpB,SAAL,IAAkB,KAAKK,YAAL,CAAkBa,IAAI,CAAChB,EAAvB,EAA2BmB,WAA7C;AACA,WAAKC,UAAL,CAAgBJ,IAAI,CAAChB,EAArB;AACD;;;WAED,2BAAkBqB,MAAlB,EAA0B;AACxB,WAAK1B,MAAL,IAAe,KAAKQ,YAAL,CAAkBkB,MAAlB,EAA0BJ,WAAzC;AACA,WAAKrB,OAAL,IAAgB,KAAKO,YAAL,CAAkBkB,MAAlB,EAA0BH,YAA1C;AACA,WAAKpB,SAAL,IAAkB,KAAKK,YAAL,CAAkBkB,MAAlB,EAA0BF,WAA5C;AACA,aAAO,KAAKhB,YAAL,CAAkBkB,MAAlB,CAAP;AACD;;;WAED,oBAAWA,MAAX,EAAmB;AACjB;AACA;AACA;AACA,aAAO,KAAKnB,KAAL,CAAWmB,MAAX,CAAP;AACD;;;WAED,yBAAgB;AACd,UAAIC,MAAM,CAACC,IAAP,CAAY,KAAKrB,KAAjB,EAAwBsB,MAAxB,GAAiC,CAArC,EAAwC;AACtC,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD;;;WAED,wBAAe;AACb,UAAIF,MAAM,CAACC,IAAP,CAAY,KAAKpB,YAAjB,EAA+BqB,MAA/B,GAAwC,CAA5C,EAA+C;AAC7C,eAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD;;;WAED,wBAAe7B,MAAf,EAAuB;AACrB,UAAI8B,MAAM,GAAG,KAAK7B,OAAL,GAAeD,MAA5B;AACA,UAAI8B,MAAM,GAAG,CAAb,EAAgBA,MAAM,GAAG,CAAT;AAEhB,WAAKC,YAAL,CAAkBD,MAAlB;AACD;;;WAED,oBAAW1B,IAAX,EAAiB;AACf,WAAKA,IAAL,IAAaA,IAAb;AACD;;;WAED,gBAAOF,MAAP,EAAe;AACb,WAAK6B,YAAL,CAAkB7B,MAAlB;AACA,WAAKU,OAAL;AACD;;;WAED,mBAAUF,GAAV,EAAe;AACb,WAAKA,GAAL,IAAYA,GAAZ;AACD;;;WAED,mBAAU;AACR,WAAKV,MAAL,IAAe,CAAf;AACA,WAAKC,OAAL,IAAgB,CAAhB;AACA,WAAKE,SAAL,IAAkB,CAAlB;AACA,WAAKM,KAAL;AACA,UAAMuB,UAAU,GAAG,KAAKtB,GAAL,GAAW,KAAKC,MAAnC;AACA,WAAKD,GAAL,GAAWsB,UAAX;AACA,WAAKrB,MAAL,GAAc,KAAKA,MAAL,GAAc,CAA5B;AACD;;;WAED,sBAAaT,MAAb,EAAqB;AACnB,WAAKA,MAAL,IAAeA,MAAf;AACA,UAAI,KAAKA,MAAL,GAAc,KAAKC,SAAvB,EAAkC,KAAKD,MAAL,GAAc,KAAKC,SAAnB;AACnC;;;WAED,iBAAQR,OAAR,EAAiB;AACf,WAAKO,MAAL,GAAc,KAAKC,SAAnB;AACA,UAAMc,QAAQ,GAAG,KAAKC,gBAAL,CAAsBvB,OAAtB,CAAjB;AACA,WAAKwB,CAAL,GAASF,QAAQ,CAAC,CAAD,CAAjB;AACA,WAAKG,CAAL,GAASH,QAAQ,CAAC,CAAD,CAAjB;AACD;;;WAED,0BAAiBtB,OAAjB,EAA0B;AACxB,UAAMsB,QAAQ,GACZ,KAAKvB,cAAL,CACEuC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,KAAKzC,cAAL,CAAoBmC,MAA/C,CADF,CADF;AAIA,UAAMO,eAAe,GAAGT,MAAM,CAACC,IAAP,CAAYjC,OAAZ,EAAqB0C,IAArB,CAA0B,UAACxC,GAAD,EAAS;AACzD,YAAIF,OAAO,CAACE,GAAD,CAAP,CAAasB,CAAb,KAAmBF,QAAQ,CAAC,CAAD,CAA3B,IAAkCtB,OAAO,CAACE,GAAD,CAAP,CAAauB,CAAb,KAAmBH,QAAQ,CAAC,CAAD,CAAjE,EAAsE;AACpE,iBAAO,IAAP;AACD,SAFD,MAEO;AACL,iBAAO,KAAP;AACD;AACF,OANuB,CAAxB;;AAQA,UAAImB,eAAJ,EAAqB;AACnB,eAAO,KAAKlB,gBAAL,CAAsBvB,OAAtB,CAAP;AACD,OAFD,MAEO;AACL,eAAOsB,QAAP;AACD;AACF","sourcesContent":["export default class PlayerModel {\r\n  constructor(playerId, spawnLocations, players, name, key, actionB, playerSchema) {\r\n    this.attack = playerSchema.attack;\r\n    this.defense = playerSchema.defense;\r\n    this.health = playerSchema.health;\r\n    this.maxHealth = playerSchema.maxHealth;\r\n    this.gold = playerSchema.gold;\r\n    this.id = playerId;\r\n    this.playerName = name;\r\n    this.key = key;\r\n    this.items = playerSchema.items || {};\r\n    this.equipedItems = playerSchema.equipedItems || {};\r\n    this.level = playerSchema.level;\r\n    this.exp = playerSchema.exp;\r\n    this.maxExp = playerSchema.maxExp;\r\n    this.potions = playerSchema.potions;\r\n    //this.playerItems =  {};\r\n\r\n    this.maxNumberOfItems = 5;\r\n\r\n    this.spawnLocations = spawnLocations;\r\n    this.actionAActive = false;\r\n    this.potionAActive = false;\r\n    this.flipX = true;\r\n    const location = this.generateLocation(players);\r\n    this.x = location[0];\r\n    this.y = location[1];\r\n  }\r\n\r\n  addItem(item) {\r\n    this.items[item.id] = item;\r\n  }\r\n\r\n  equipItem(item) {\r\n    this.equipedItems[item.id] = item;\r\n\r\n    this.attack += this.equipedItems[item.id].attackBonus;\r\n    this.defense += this.equipedItems[item.id].defenseBonus;\r\n    this.maxHealth += this.equipedItems[item.id].healthBonus;\r\n    this.removeItem(item.id);\r\n  }\r\n\r\n  removeEquipedItem(itemId) {\r\n    this.attack -= this.equipedItems[itemId].attackBonus;\r\n    this.defense -= this.equipedItems[itemId].defenseBonus;\r\n    this.maxHealth -= this.equipedItems[itemId].healthBonus;\r\n    delete this.equipedItems[itemId];\r\n  }\r\n\r\n  removeItem(itemId) {\r\n    // this.attack -= this.items[itemId].attackBonus;\r\n    // this.defense -= this.items[itemId].defenseBonus;\r\n    // this.maxHealth -= this.items[itemId].healthBonus;\r\n    delete this.items[itemId];\r\n  }\r\n\r\n  canPickupItem() {\r\n    if (Object.keys(this.items).length < 5) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  canEquipItem() {\r\n    if (Object.keys(this.equipedItems).length < 5) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  playerAttacked(attack) {\r\n    let damage = this.defense - attack;\r\n    if (damage > 0) damage = 0;\r\n\r\n    this.updateHealth(damage);\r\n  }\r\n\r\n  updateGold(gold) {\r\n    this.gold += gold;\r\n  }\r\n\r\n  potion(health) {\r\n    this.updateHealth(health);\r\n    this.potions--;\r\n  }\r\n\r\n  updateExp(exp) {\r\n    this.exp += exp;\r\n  }\r\n\r\n  levelUp() {\r\n    this.attack += 3;\r\n    this.defense += 2;\r\n    this.maxHealth += 1;\r\n    this.level++;\r\n    const calcNewExp = this.exp - this.maxExp;\r\n    this.exp = calcNewExp;\r\n    this.maxExp = this.maxExp * 2;\r\n  }\r\n\r\n  updateHealth(health) {\r\n    this.health += health;\r\n    if (this.health > this.maxHealth) this.health = this.maxHealth;\r\n  }\r\n\r\n  respawn(players) {\r\n    this.health = this.maxHealth;\r\n    const location = this.generateLocation(players);\r\n    this.x = location[0];\r\n    this.y = location[1];\r\n  }\r\n\r\n  generateLocation(players) {\r\n    const location =\r\n      this.spawnLocations[\r\n        Math.floor(Math.random() * this.spawnLocations.length)\r\n      ];\r\n    const invalidLocation = Object.keys(players).some((key) => {\r\n      if (players[key].x === location[0] && players[key].y === location[1]) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    if (invalidLocation) {\r\n      return this.generateLocation(players);\r\n    } else {\r\n      return location;\r\n    }\r\n  }\r\n}\r\n"],"file":"PlayerModel.js"}