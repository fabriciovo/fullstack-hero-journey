{"version":3,"sources":["../../src/game_manager/Spawner.js"],"names":["Spawner","config","spawnLocations","addObject","deleteObject","moveObjects","id","spawnInterval","limit","objectType","spawnerType","objectsCreated","start","interval","setInterval","length","spawnObject","SpawnerType","MONSTER","moveMonsters","CHEST","spawnChest","spawnMonster","location","pickRandomLocation","chest","ChestModel","push","monster","MonsterModel","Math","floor","random","invalidLocation","some","obj","x","y","filter","moveMonsterInterval","forEach","move"],"mappings":"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","sourcesContent":["import { SpawnerType, randomNumber } from './utils';\r\nimport ChestModel from './ChestModel';\r\nimport MonsterModel from './MonsterModel';\r\n\r\nexport default class Spawner {\r\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\r\n    this.id = config.id;\r\n    this.spawnInterval = config.spawnInterval;\r\n    this.limit = config.limit;\r\n    this.objectType = config.spawnerType;\r\n    this.spawnLocations = spawnLocations;\r\n    this.addObject = addObject;\r\n    this.deleteObject = deleteObject;\r\n    this.moveObjects = moveObjects;\r\n\r\n    this.objectsCreated = [];\r\n\r\n    this.start();\r\n  }\r\n\r\n  start() {\r\n    this.interval = setInterval(() => {\r\n      if (this.objectsCreated.length < this.limit) {\r\n        this.spawnObject();\r\n      }\r\n    }, this.spawnInterval);\r\n    if (this.objectType === SpawnerType.MONSTER) this.moveMonsters();\r\n  }\r\n\r\n  spawnObject() {\r\n    if (this.objectType === SpawnerType.CHEST) {\r\n      this.spawnChest();\r\n    } else if (this.objectType === SpawnerType.MONSTER) {\r\n      this.spawnMonster();\r\n    }\r\n  }\r\n\r\n  spawnChest() {\r\n    const location = this.pickRandomLocation();\r\n    const chest = new ChestModel(location[0], location[1], randomNumber(10, 20), this.id);\r\n    this.objectsCreated.push(chest);\r\n    this.addObject(chest.id, chest);\r\n  }\r\n\r\n  spawnMonster() {\r\n    const location = this.pickRandomLocation();\r\n    const monster = new MonsterModel(\r\n      location[0],\r\n      location[1],\r\n      randomNumber(10, 20),\r\n      this.id,\r\n      randomNumber(0, 20),\r\n      randomNumber(3, 5),\r\n      1,\r\n    );\r\n    this.objectsCreated.push(monster);\r\n    this.addObject(monster.id, monster);\r\n  }\r\n\r\n  pickRandomLocation() {\r\n    const location = this.spawnLocations[Math.floor(Math.random() * this.spawnLocations.length)];\r\n    const invalidLocation = this.objectsCreated.some((obj) => {\r\n      if (obj.x === location[0] && obj.y === location[1]) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n\r\n    if (invalidLocation) return this.pickRandomLocation();\r\n    return location;\r\n  }\r\n\r\n  removeObject(id) {\r\n    this.objectsCreated = this.objectsCreated.filter(obj => obj.id !== id);\r\n    this.deleteObject(id);\r\n  }\r\n\r\n  moveMonsters() {\r\n    this.moveMonsterInterval = setInterval(() => {\r\n      this.objectsCreated.forEach((monster) => {\r\n        monster.move();\r\n      });\r\n\r\n      this.moveObjects();\r\n    }, 1000);\r\n  }\r\n}\r\n"],"file":"Spawner.js"}