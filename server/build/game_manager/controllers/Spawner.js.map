{"version":3,"sources":["../../../src/game_manager/controllers/Spawner.js"],"names":["getRandonValues","bonus","Math","floor","random","length","Spawner","config","spawnLocations","addObject","deleteObject","moveObjects","id","spawnInterval","limit","objectType","spawnerType","objectsCreated","start","interval","setInterval","spawnObject","SpawnerType","CHEST","spawnChest","MONSTER","spawnMonster","ITEM","spawnItem","NPC","spawnNpc","location","pickRandomLocation","randomItem","itemData","items","item","ItemModel","name","frame","WeaponTypes","MELEE","push","chest","ChestModel","randomEnemy","enemyData","enemies","monster","MonsterModel","goldValue","key","healthValue","attackValue","expValue","npc","NpcModel","invalidLocation","some","obj","x","y","filter"],"mappings":"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","sourcesContent":["import { SpawnerType, randomNumber, WeaponTypes } from \"../utils\";\r\nimport ChestModel from \"../../models/ChestModel\";\r\nimport MonsterModel from \"../../models/MonsterModel\";\r\nimport ItemModel from \"../../models/ItemModel\";\r\nimport * as itemData from \"../../../public/assets/level/tools.json\";\r\nimport * as enemyData from \"../../../public/assets/Enemies/enemies.json\";\r\n\r\nimport NpcModel from \"../../models/NpcModel\";\r\n\r\nfunction getRandonValues() {\r\n  const bonus = [\r\n    -3, -5, -6, 0, 5, 3, 4, 7, 2, 1, 8, 10, 11, 23, 12, 13, 14, 15, 16, 9,\r\n  ];\r\n  return bonus[Math.floor(Math.random() * bonus.length)];\r\n}\r\n\r\nexport default class Spawner {\r\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\r\n    this.id = config.id;\r\n    this.spawnInterval = config.spawnInterval;\r\n    this.limit = config.limit;\r\n    this.objectType = config.spawnerType;\r\n    this.spawnLocations = spawnLocations;\r\n    this.addObject = addObject;\r\n    this.deleteObject = deleteObject;\r\n    this.moveObjects = moveObjects;\r\n\r\n    this.objectsCreated = [];\r\n\r\n    this.start();\r\n  }\r\n\r\n  start() {\r\n    this.interval = setInterval(() => {\r\n      if (this.objectsCreated.length < this.limit) {\r\n        this.spawnObject();\r\n      }\r\n    }, this.spawnInterval);\r\n  }\r\n\r\n  spawnObject() {\r\n    if (this.objectType === SpawnerType.CHEST) {\r\n      this.spawnChest();\r\n    } else if (this.objectType === SpawnerType.MONSTER) {\r\n      this.spawnMonster();\r\n    } else if (this.objectType === SpawnerType.ITEM) {\r\n      this.spawnItem();\r\n    } else if (this.objectType === SpawnerType.NPC) {\r\n      this.spawnNpc();\r\n    }\r\n  }\r\n\r\n  spawnItem() {\r\n    const location = this.pickRandomLocation();\r\n\r\n    const randomItem =\r\n      itemData.items[Math.floor(Math.random() * itemData.items.length)];\r\n\r\n    const item = new ItemModel(\r\n      location[0],\r\n      location[1],\r\n      this.id,\r\n      randomItem.name,\r\n      randomItem.frame,\r\n      getRandonValues(),\r\n      getRandonValues(),\r\n      getRandonValues(),\r\n      WeaponTypes.MELEE,\r\n      \"Description\"\r\n    );\r\n    this.objectsCreated.push(item);\r\n    this.addObject(item.id, item);\r\n  }\r\n\r\n  spawnChest() {\r\n    const location = this.pickRandomLocation();\r\n    const chest = new ChestModel(\r\n      location[0],\r\n      location[1],\r\n      randomNumber(10, 20),\r\n      this.id\r\n    );\r\n    this.objectsCreated.push(chest);\r\n    this.addObject(chest.id, chest);\r\n  }\r\n\r\n  spawnMonster() {\r\n    const randomEnemy =\r\n      enemyData.enemies[Math.floor(Math.random() * enemyData.enemies.length)];\r\n\r\n    const location = this.pickRandomLocation();\r\n    const monster = new MonsterModel(\r\n      location[0],\r\n      location[1],\r\n      randomEnemy.goldValue, // gold value\r\n      this.id,\r\n      randomEnemy.key, // key\r\n      randomEnemy.healthValue, // health value\r\n      randomEnemy.attackValue, // attack value\r\n      randomEnemy.expValue // exp value\r\n    );\r\n    this.objectsCreated.push(monster);\r\n    this.addObject(monster.id, monster);\r\n  }\r\n\r\n  spawnNpc() {\r\n    const location = this.pickRandomLocation();\r\n    const npc = new NpcModel(location[0], location[1], this.id);\r\n    this.objectsCreated.push(npc);\r\n    this.addObject(npc.id, npc);\r\n  }\r\n\r\n  pickRandomLocation() {\r\n    const location =\r\n      this.spawnLocations[\r\n        Math.floor(Math.random() * this.spawnLocations.length)\r\n      ];\r\n    const invalidLocation = this.objectsCreated.some((obj) => {\r\n      if (obj.x === location[0] && obj.y === location[1]) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n\r\n    if (invalidLocation) return this.pickRandomLocation();\r\n    return location;\r\n  }\r\n\r\n  removeObject(id) {\r\n    this.objectsCreated = this.objectsCreated.filter((obj) => obj.id !== id);\r\n    this.deleteObject(id);\r\n  }\r\n}\r\n"],"file":"Spawner.js"}