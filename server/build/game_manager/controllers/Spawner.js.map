{"version":3,"sources":["../../../src/game_manager/controllers/Spawner.js"],"names":["Spawner","config","spawnLocations","addObject","deleteObject","moveObjects","id","spawnInterval","limit","objectType","spawnerType","monsterIntervalTimer","objectsCreated","start","interval","setInterval","length","spawnObject","SpawnerType","MONSTER","moveMonsters","CHEST","spawnChest","spawnMonster","ITEM","spawnItem","NPC","spawnNpc","location","pickRandomLocation","randomItem","itemData","items","Math","floor","random","item","ItemModel","name","frame","WeaponTypes","MELEE","push","chest","ChestModel","randomEnemy","enemyData","enemies","monster","MonsterModel","goldValue","key","healthValue","attackValue","expValue","npc","NpcModel","invalidLocation","some","obj","x","y","filter","moveMonsterInterval","forEach","move","value","clearInterval","startInterval"],"mappings":"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","sourcesContent":["import {\r\n  SpawnerType,\r\n  randomNumber,\r\n  WeaponTypes,\r\n  getRandonValues,\r\n} from \"../utils\";\r\nimport ChestModel from \"../../models/ChestModel\";\r\nimport MonsterModel from \"../../models/MonsterModel\";\r\nimport ItemModel from \"../../models/ItemModel\";\r\nimport * as itemData from \"../../../public/assets/level/tools.json\";\r\nimport * as enemyData from \"../../../public/assets/Enemies/enemies.json\";\r\nimport NpcModel from \"../../models/NpcModel\";\r\n\r\nexport default class Spawner {\r\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\r\n    this.id = config.id;\r\n    this.spawnInterval = config.spawnInterval;\r\n    this.limit = config.limit;\r\n    this.objectType = config.spawnerType;\r\n    this.spawnLocations = spawnLocations;\r\n    this.addObject = addObject;\r\n    this.deleteObject = deleteObject;\r\n    this.moveObjects = moveObjects;\r\n    this.monsterIntervalTimer = 1000;\r\n    this.objectsCreated = [];\r\n\r\n    this.start();\r\n  }\r\n\r\n  start() {\r\n    this.interval = setInterval(() => {\r\n      if (this.objectsCreated.length < this.limit) {\r\n        this.spawnObject();\r\n      }\r\n    }, this.spawnInterval);\r\n    if (this.objectType === SpawnerType.MONSTER) this.moveMonsters();\r\n  }\r\n\r\n  spawnObject() {\r\n    if (this.objectType === SpawnerType.CHEST) {\r\n      this.spawnChest();\r\n    } else if (this.objectType === SpawnerType.MONSTER) {\r\n      this.spawnMonster();\r\n    } else if (this.objectType === SpawnerType.ITEM) {\r\n      this.spawnItem();\r\n    } else if (this.objectType === SpawnerType.NPC) {\r\n      this.spawnNpc();\r\n    }\r\n  }\r\n\r\n  spawnItem() {\r\n    const location = this.pickRandomLocation();\r\n\r\n    const randomItem =\r\n      itemData.items[Math.floor(Math.random() * itemData.items.length)];\r\n\r\n    const item = new ItemModel(\r\n      location[0],\r\n      location[1],\r\n      this.id,\r\n      randomItem.name,\r\n      randomItem.frame,\r\n      getRandonValues(),\r\n      getRandonValues(),\r\n      getRandonValues(),\r\n      WeaponTypes.MELEE,\r\n      \"Description\"\r\n    );\r\n    this.objectsCreated.push(item);\r\n    this.addObject(item.id, item);\r\n  }\r\n\r\n  spawnChest() {\r\n    const location = this.pickRandomLocation();\r\n    const chest = new ChestModel(\r\n      location[0],\r\n      location[1],\r\n      randomNumber(10, 20),\r\n      this.id\r\n    );\r\n    this.objectsCreated.push(chest);\r\n    this.addObject(chest.id, chest);\r\n  }\r\n\r\n  spawnMonster() {\r\n    const randomEnemy =\r\n      enemyData.enemies[Math.floor(Math.random() * enemyData.enemies.length)];\r\n\r\n    const location = this.pickRandomLocation();\r\n    const monster = new MonsterModel(\r\n      location[0],\r\n      location[1],\r\n      randomEnemy.goldValue, // gold value\r\n      this.id,\r\n      randomEnemy.key, // key\r\n      randomEnemy.healthValue, // health value\r\n      randomEnemy.attackValue, // attack value\r\n      randomEnemy.expValue, // exp value\r\n      3000 //timer\r\n    );\r\n    this.objectsCreated.push(monster);\r\n    this.addObject(monster.id, monster);\r\n  }\r\n\r\n  spawnNpc() {\r\n    const location = this.pickRandomLocation();\r\n    const npc = new NpcModel(location[0], location[1], this.id);\r\n    this.objectsCreated.push(npc);\r\n    this.addObject(npc.id, npc);\r\n  }\r\n\r\n  pickRandomLocation() {\r\n    const location =\r\n      this.spawnLocations[\r\n        Math.floor(Math.random() * this.spawnLocations.length)\r\n      ];\r\n    const invalidLocation = this.objectsCreated.some((obj) => {\r\n      if (obj.x === location[0] && obj.y === location[1]) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n\r\n    if (invalidLocation) return this.pickRandomLocation();\r\n    return location;\r\n  }\r\n\r\n  removeObject(id) {\r\n    this.objectsCreated = this.objectsCreated.filter((obj) => obj.id !== id);\r\n    this.deleteObject(id);\r\n  }\r\n\r\n  moveMonsters() {\r\n    this.moveMonsterInterval = setInterval(() => {\r\n      this.objectsCreated.forEach((monster) => {\r\n        monster.move();\r\n      });\r\n      this.moveObjects();\r\n    }, this.monsterIntervalTimer);\r\n  }\r\n\r\n  resetMonsterInterval(value) {\r\n    // clear the existing interval\r\n    this.monsterIntervalTimer = value;\r\n    clearInterval(this.moveMonsterInterval);\r\n    // just start a new one\r\n    startInterval(this.moveMonsterInterval);\r\n  }\r\n}\r\n"],"file":"Spawner.js"}