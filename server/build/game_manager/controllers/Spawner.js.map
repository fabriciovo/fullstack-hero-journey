{"version":3,"file":"Spawner.js","names":["_utils","require","_ChestModel","_interopRequireDefault","_MonsterModel","_ItemModel","itemData","_interopRequireWildcard","enemyData","_NpcModel","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","Spawner","exports","config","spawnLocations","addObject","deleteObject","moveObjects","_classCallCheck2","id","spawnInterval","limit","objectType","spawnerType","monsterIntervalTimer","objectsCreated","start","_createClass2","key","value","_this","interval","setInterval","length","spawnObject","SpawnerType","MONSTER","moveMonsters","CHEST","spawnChest","spawnMonster","ITEM","spawnItem","NPC","spawnNpc","location","pickRandomLocation","randomItem","items","Math","floor","random","item","ItemModel","name","frame","getRandonValues","WeaponTypes","MELEE","push","chest","ChestModel","randomNumber","randomEnemy","enemies","monster","MonsterModel","goldValue","healthValue","attackValue","expValue","npc","NpcModel","invalidLocation","some","obj","x","y","removeObject","filter","_this2","moveMonsterInterval","forEach","move","resetMonsterInterval","_this3","clearInterval"],"sources":["../../../src/game_manager/controllers/Spawner.js"],"sourcesContent":["import {\n  SpawnerType,\n  randomNumber,\n  WeaponTypes,\n  getRandonValues,\n} from \"../utils\";\nimport ChestModel from \"../../models/ChestModel\";\nimport MonsterModel from \"../../models/MonsterModel\";\nimport ItemModel from \"../../models/ItemModel\";\nimport * as itemData from \"../../../public/assets/level/tools.json\";\nimport * as enemyData from \"../../../public/assets/Enemies/enemies.json\";\nimport NpcModel from \"../../models/NpcModel\";\n\nexport default class Spawner {\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\n    this.id = config.id;\n    this.spawnInterval = config.spawnInterval;\n    this.limit = config.limit;\n    this.objectType = config.spawnerType;\n    this.spawnLocations = spawnLocations;\n    this.addObject = addObject;\n    this.deleteObject = deleteObject;\n    this.moveObjects = moveObjects;\n    this.monsterIntervalTimer = 1000;\n    this.objectsCreated = [];\n\n    this.start();\n  }\n\n  start() {\n    this.interval = setInterval(() => {\n      if (this.objectsCreated.length < this.limit) {\n        this.spawnObject();\n      }\n    }, this.spawnInterval);\n    if (this.objectType === SpawnerType.MONSTER) this.moveMonsters();\n  }\n\n  spawnObject() {\n    if (this.objectType === SpawnerType.CHEST) {\n      this.spawnChest();\n    } else if (this.objectType === SpawnerType.MONSTER) {\n      this.spawnMonster();\n    } else if (this.objectType === SpawnerType.ITEM) {\n      this.spawnItem();\n    } else if (this.objectType === SpawnerType.NPC) {\n      this.spawnNpc();\n    }\n  }\n\n  spawnItem() {\n    const location = this.pickRandomLocation();\n\n    const randomItem =\n      itemData.items[Math.floor(Math.random() * itemData.items.length)];\n\n    const item = new ItemModel(\n      location[0],\n      location[1],\n      this.id,\n      randomItem.name,\n      randomItem.frame,\n      getRandonValues(),\n      getRandonValues(),\n      getRandonValues(),\n      WeaponTypes.MELEE,\n      \"Description\"\n    );\n    this.objectsCreated.push(item);\n    this.addObject(item.id, item);\n  }\n\n  spawnChest() {\n    const location = this.pickRandomLocation();\n    const chest = new ChestModel(\n      location[0],\n      location[1],\n      randomNumber(10, 20),\n      this.id\n    );\n    this.objectsCreated.push(chest);\n    this.addObject(chest.id, chest);\n  }\n\n  spawnMonster() {\n    const randomEnemy =\n      enemyData.enemies[Math.floor(Math.random() * enemyData.enemies.length)];\n\n    const location = this.pickRandomLocation();\n    const monster = new MonsterModel(\n      location[0],\n      location[1],\n      randomEnemy.goldValue, // gold value\n      this.id,\n      randomEnemy.key, // key\n      randomEnemy.healthValue, // health value\n      randomEnemy.attackValue, // attack value\n      randomEnemy.expValue, // exp value\n      3000 //timer\n    );\n    this.objectsCreated.push(monster);\n    this.addObject(monster.id, monster);\n  }\n\n  spawnNpc() {\n    const location = this.pickRandomLocation();\n    const npc = new NpcModel(location[0], location[1], this.id);\n    this.objectsCreated.push(npc);\n    this.addObject(npc.id, npc);\n  }\n\n  pickRandomLocation() {\n    const location =\n      this.spawnLocations[\n        Math.floor(Math.random() * this.spawnLocations.length)\n      ];\n    const invalidLocation = this.objectsCreated.some((obj) => {\n      if (obj.x === location[0] && obj.y === location[1]) {\n        return true;\n      }\n      return false;\n    });\n\n    if (invalidLocation) return this.pickRandomLocation();\n    return location;\n  }\n\n  removeObject(id) {\n    this.objectsCreated = this.objectsCreated.filter((obj) => obj.id !== id);\n    this.deleteObject(id);\n  }\n\n  moveMonsters() {\n    this.moveMonsterInterval = setInterval(() => {\n      this.objectsCreated.forEach((monster) => {\n        monster.move();\n      });\n      this.moveObjects();\n    }, this.monsterIntervalTimer);\n  }\n\n  resetMonsterInterval(value) {\n    // clear the existing interval\n    this.monsterIntervalTimer = value;\n    clearInterval(this.moveMonsterInterval);\n    // just start a new one\n    this.moveMonsterInterval = setInterval(() => {\n      this.objectsCreated.forEach((monster) => {\n        monster.move();\n      });\n      this.moveObjects();\n    }, this.monsterIntervalTimer);\n  }\n}\n"],"mappings":";;;;;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAMA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,aAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,UAAA,GAAAF,sBAAA,CAAAF,OAAA;AACA,IAAAK,QAAA,GAAAC,uBAAA,CAAAN,OAAA;AACA,IAAAO,SAAA,GAAAD,uBAAA,CAAAN,OAAA;AACA,IAAAQ,SAAA,GAAAN,sBAAA,CAAAF,OAAA;AAA6C,SAAAS,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,yBAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAJ,wBAAAI,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,gBAAAK,OAAA,CAAAL,CAAA,0BAAAA,CAAA,sBAAAA,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,cAAAR,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA,IAExBW,OAAO,GAAAC,OAAA;EAC1B,SAAAD,QAAYE,MAAM,EAAEC,cAAc,EAAEC,SAAS,EAAEC,YAAY,EAAEC,WAAW,EAAE;IAAA,IAAAC,gBAAA,mBAAAP,OAAA;IACxE,IAAI,CAACQ,EAAE,GAAGN,MAAM,CAACM,EAAE;IACnB,IAAI,CAACC,aAAa,GAAGP,MAAM,CAACO,aAAa;IACzC,IAAI,CAACC,KAAK,GAAGR,MAAM,CAACQ,KAAK;IACzB,IAAI,CAACC,UAAU,GAAGT,MAAM,CAACU,WAAW;IACpC,IAAI,CAACT,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACC,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,YAAY,GAAGA,YAAY;IAChC,IAAI,CAACC,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACO,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAACC,cAAc,GAAG,EAAE;IAExB,IAAI,CAACC,KAAK,CAAC,CAAC;EACd;EAAC,WAAAC,aAAA,aAAAhB,OAAA;IAAAiB,GAAA;IAAAC,KAAA,EAED,SAAAH,MAAA,EAAQ;MAAA,IAAAI,KAAA;MACN,IAAI,CAACC,QAAQ,GAAGC,WAAW,CAAC,YAAM;QAChC,IAAIF,KAAI,CAACL,cAAc,CAACQ,MAAM,GAAGH,KAAI,CAACT,KAAK,EAAE;UAC3CS,KAAI,CAACI,WAAW,CAAC,CAAC;QACpB;MACF,CAAC,EAAE,IAAI,CAACd,aAAa,CAAC;MACtB,IAAI,IAAI,CAACE,UAAU,KAAKa,kBAAW,CAACC,OAAO,EAAE,IAAI,CAACC,YAAY,CAAC,CAAC;IAClE;EAAC;IAAAT,GAAA;IAAAC,KAAA,EAED,SAAAK,YAAA,EAAc;MACZ,IAAI,IAAI,CAACZ,UAAU,KAAKa,kBAAW,CAACG,KAAK,EAAE;QACzC,IAAI,CAACC,UAAU,CAAC,CAAC;MACnB,CAAC,MAAM,IAAI,IAAI,CAACjB,UAAU,KAAKa,kBAAW,CAACC,OAAO,EAAE;QAClD,IAAI,CAACI,YAAY,CAAC,CAAC;MACrB,CAAC,MAAM,IAAI,IAAI,CAAClB,UAAU,KAAKa,kBAAW,CAACM,IAAI,EAAE;QAC/C,IAAI,CAACC,SAAS,CAAC,CAAC;MAClB,CAAC,MAAM,IAAI,IAAI,CAACpB,UAAU,KAAKa,kBAAW,CAACQ,GAAG,EAAE;QAC9C,IAAI,CAACC,QAAQ,CAAC,CAAC;MACjB;IACF;EAAC;IAAAhB,GAAA;IAAAC,KAAA,EAED,SAAAa,UAAA,EAAY;MACV,IAAMG,QAAQ,GAAG,IAAI,CAACC,kBAAkB,CAAC,CAAC;MAE1C,IAAMC,UAAU,GACd5D,QAAQ,CAAC6D,KAAK,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAGhE,QAAQ,CAAC6D,KAAK,CAACf,MAAM,CAAC,CAAC;MAEnE,IAAMmB,IAAI,GAAG,IAAIC,qBAAS,CACxBR,QAAQ,CAAC,CAAC,CAAC,EACXA,QAAQ,CAAC,CAAC,CAAC,EACX,IAAI,CAAC1B,EAAE,EACP4B,UAAU,CAACO,IAAI,EACfP,UAAU,CAACQ,KAAK,EAChB,IAAAC,sBAAe,EAAC,CAAC,EACjB,IAAAA,sBAAe,EAAC,CAAC,EACjB,IAAAA,sBAAe,EAAC,CAAC,EACjBC,kBAAW,CAACC,KAAK,EACjB,aACF,CAAC;MACD,IAAI,CAACjC,cAAc,CAACkC,IAAI,CAACP,IAAI,CAAC;MAC9B,IAAI,CAACrC,SAAS,CAACqC,IAAI,CAACjC,EAAE,EAAEiC,IAAI,CAAC;IAC/B;EAAC;IAAAxB,GAAA;IAAAC,KAAA,EAED,SAAAU,WAAA,EAAa;MACX,IAAMM,QAAQ,GAAG,IAAI,CAACC,kBAAkB,CAAC,CAAC;MAC1C,IAAMc,KAAK,GAAG,IAAIC,sBAAU,CAC1BhB,QAAQ,CAAC,CAAC,CAAC,EACXA,QAAQ,CAAC,CAAC,CAAC,EACX,IAAAiB,mBAAY,EAAC,EAAE,EAAE,EAAE,CAAC,EACpB,IAAI,CAAC3C,EACP,CAAC;MACD,IAAI,CAACM,cAAc,CAACkC,IAAI,CAACC,KAAK,CAAC;MAC/B,IAAI,CAAC7C,SAAS,CAAC6C,KAAK,CAACzC,EAAE,EAAEyC,KAAK,CAAC;IACjC;EAAC;IAAAhC,GAAA;IAAAC,KAAA,EAED,SAAAW,aAAA,EAAe;MACb,IAAMuB,WAAW,GACf1E,SAAS,CAAC2E,OAAO,CAACf,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG9D,SAAS,CAAC2E,OAAO,CAAC/B,MAAM,CAAC,CAAC;MAEzE,IAAMY,QAAQ,GAAG,IAAI,CAACC,kBAAkB,CAAC,CAAC;MAC1C,IAAMmB,OAAO,GAAG,IAAIC,wBAAY,CAC9BrB,QAAQ,CAAC,CAAC,CAAC,EACXA,QAAQ,CAAC,CAAC,CAAC,EACXkB,WAAW,CAACI,SAAS;MAAE;MACvB,IAAI,CAAChD,EAAE,EACP4C,WAAW,CAACnC,GAAG;MAAE;MACjBmC,WAAW,CAACK,WAAW;MAAE;MACzBL,WAAW,CAACM,WAAW;MAAE;MACzBN,WAAW,CAACO,QAAQ;MAAE;MACtB,IAAI,CAAC;MACP,CAAC;MACD,IAAI,CAAC7C,cAAc,CAACkC,IAAI,CAACM,OAAO,CAAC;MACjC,IAAI,CAAClD,SAAS,CAACkD,OAAO,CAAC9C,EAAE,EAAE8C,OAAO,CAAC;IACrC;EAAC;IAAArC,GAAA;IAAAC,KAAA,EAED,SAAAe,SAAA,EAAW;MACT,IAAMC,QAAQ,GAAG,IAAI,CAACC,kBAAkB,CAAC,CAAC;MAC1C,IAAMyB,GAAG,GAAG,IAAIC,oBAAQ,CAAC3B,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC1B,EAAE,CAAC;MAC3D,IAAI,CAACM,cAAc,CAACkC,IAAI,CAACY,GAAG,CAAC;MAC7B,IAAI,CAACxD,SAAS,CAACwD,GAAG,CAACpD,EAAE,EAAEoD,GAAG,CAAC;IAC7B;EAAC;IAAA3C,GAAA;IAAAC,KAAA,EAED,SAAAiB,mBAAA,EAAqB;MACnB,IAAMD,QAAQ,GACZ,IAAI,CAAC/B,cAAc,CACjBmC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG,IAAI,CAACrC,cAAc,CAACmB,MAAM,CAAC,CACvD;MACH,IAAMwC,eAAe,GAAG,IAAI,CAAChD,cAAc,CAACiD,IAAI,CAAC,UAACC,GAAG,EAAK;QACxD,IAAIA,GAAG,CAACC,CAAC,KAAK/B,QAAQ,CAAC,CAAC,CAAC,IAAI8B,GAAG,CAACE,CAAC,KAAKhC,QAAQ,CAAC,CAAC,CAAC,EAAE;UAClD,OAAO,IAAI;QACb;QACA,OAAO,KAAK;MACd,CAAC,CAAC;MAEF,IAAI4B,eAAe,EAAE,OAAO,IAAI,CAAC3B,kBAAkB,CAAC,CAAC;MACrD,OAAOD,QAAQ;IACjB;EAAC;IAAAjB,GAAA;IAAAC,KAAA,EAED,SAAAiD,aAAa3D,EAAE,EAAE;MACf,IAAI,CAACM,cAAc,GAAG,IAAI,CAACA,cAAc,CAACsD,MAAM,CAAC,UAACJ,GAAG;QAAA,OAAKA,GAAG,CAACxD,EAAE,KAAKA,EAAE;MAAA,EAAC;MACxE,IAAI,CAACH,YAAY,CAACG,EAAE,CAAC;IACvB;EAAC;IAAAS,GAAA;IAAAC,KAAA,EAED,SAAAQ,aAAA,EAAe;MAAA,IAAA2C,MAAA;MACb,IAAI,CAACC,mBAAmB,GAAGjD,WAAW,CAAC,YAAM;QAC3CgD,MAAI,CAACvD,cAAc,CAACyD,OAAO,CAAC,UAACjB,OAAO,EAAK;UACvCA,OAAO,CAACkB,IAAI,CAAC,CAAC;QAChB,CAAC,CAAC;QACFH,MAAI,CAAC/D,WAAW,CAAC,CAAC;MACpB,CAAC,EAAE,IAAI,CAACO,oBAAoB,CAAC;IAC/B;EAAC;IAAAI,GAAA;IAAAC,KAAA,EAED,SAAAuD,qBAAqBvD,KAAK,EAAE;MAAA,IAAAwD,MAAA;MAC1B;MACA,IAAI,CAAC7D,oBAAoB,GAAGK,KAAK;MACjCyD,aAAa,CAAC,IAAI,CAACL,mBAAmB,CAAC;MACvC;MACA,IAAI,CAACA,mBAAmB,GAAGjD,WAAW,CAAC,YAAM;QAC3CqD,MAAI,CAAC5D,cAAc,CAACyD,OAAO,CAAC,UAACjB,OAAO,EAAK;UACvCA,OAAO,CAACkB,IAAI,CAAC,CAAC;QAChB,CAAC,CAAC;QACFE,MAAI,CAACpE,WAAW,CAAC,CAAC;MACpB,CAAC,EAAE,IAAI,CAACO,oBAAoB,CAAC;IAC/B;EAAC;AAAA","ignoreList":[]}