{"version":3,"file":"ItemController.js","names":["_ChestModel","_interopRequireDefault","require","_ItemModel","itemData","_interopRequireWildcard","_uuid","_utils","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ItemController","exports","io","_classCallCheck2","chests","items","itemDictionary","chest","createChest","bind","item","createItem","drop","_createClass2","key","value","setupEventListeners","socket","_this","on","itemId","player","canPickupItem","addItem","emit","broadcast","id","deleteItems","chestId","gold","updateGold","deleteChest","x","y","addItems","addChest","ChestModel","randomNumber","concat","v4","randomItem","Math","floor","random","length","ItemModel","name","frame","getRandonValues","WeaponTypes","MELEE"],"sources":["../../../src/game_manager/controllers/ItemController.js"],"sourcesContent":["import ChestModel from \"../../models/ChestModel\";\nimport ItemModel from \"../../models/ItemModel\";\nimport * as itemData from \"../../../public/assets/level/tools.json\";\nimport { v4 } from \"uuid\";\nimport { getRandonValues, randomNumber, WeaponTypes } from \"../utils\";\n\nexport default class ItemController {\n  constructor(io) {\n    this.chests = {};\n    this.items = {};\n    this.io = io;\n\n    this.itemDictionary = {\n      chest: this.createChest.bind(this),\n      item: this.createItem.bind(this),\n      \"\": this.drop.bind(this),\n    };\n  }\n\n  setupEventListeners(socket) {\n    socket.on(\"playerPickupItem\", (itemId, player) => {\n      if (this.items[itemId]) {\n        if (player.canPickupItem()) {\n          player.addItem(this.items[itemId]);\n          socket.emit(\"updateItems\", player);\n          socket.broadcast.emit(\n            \"updatePlayersItems\",\n            socket.id,\n            player\n          );\n          this.deleteItems(itemId);\n        }\n      }\n\n    });\n\n    socket.on(\"pickUpChest\", (chestId, player) => {\n      if (this.chests[chestId]) {\n        const { gold } = this.chests[chestId];\n        // updating the players gold\n        player.updateGold(gold);\n        socket.emit(\"updateScore\", player.gold);\n        socket.broadcast.emit(\n          \"updatePlayersScore\",\n          socket.id,\n          player.gold\n        );\n      this.deleteChest(chestId);\n      }\n    });\n\n    socket.on(\"dropItem\", (x, y, item) => {\n      this.itemDictionary[item](x, y);\n    });\n  }\n\n\n  addItems(itemId, item) {\n    this.items[itemId] = item;\n    this.io.emit(\"itemSpawned\", item);\n  }\n\n  deleteItems(itemId) {\n    delete this.items[itemId];\n    this.io.emit(\"itemRemoved\", itemId);\n  }\n\n  addChest(chestId, chest) {\n    this.chests[chestId] = chest;\n    this.io.emit(\"chestSpawned\", chest);\n  }\n\n  deleteChest(chestId) {\n    delete this.chests[chestId];\n    this.io.emit(\"chestRemoved\", chestId);\n  }\n\n  drop(x, y) {}\n\n  createChest(x, y) {\n    const chest = new ChestModel(x, y, randomNumber(10, 20), `chest-${v4()}`);\n    this.addChest(chest.id, chest);\n  }\n\n  createItem(x, y) {\n    const randomItem =\n      itemData.items[Math.floor(Math.random() * itemData.items.length)];\n\n    const item = new ItemModel(\n      x,\n      y,\n      `item-${v4()}`,\n      randomItem.name,\n      randomItem.frame,\n      getRandonValues(),\n      getRandonValues(),\n      getRandonValues(),\n      WeaponTypes.MELEE,\n      \"Description\"\n    );\n\n    this.addItems(item.id, item);\n  }\n}\n"],"mappings":"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","ignoreList":[]}