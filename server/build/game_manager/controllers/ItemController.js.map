{"version":3,"file":"ItemController.js","names":["_ChestModel","_interopRequireDefault","require","_ItemModel","itemData","_interopRequireWildcard","_uuid","_utils","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ItemController","exports","io","_classCallCheck2","chests","items","itemDictionary","chest","createChest","bind","item","createItem","drop","_createClass2","key","value","setupEventListeners","socket","_this","on","itemId","player","console","log","canPickupItem","addItem","emit","broadcast","id","deleteItems","chestId","gold","updateGold","deleteChest","x","y","addItems","addChest","ChestModel","randomNumber","concat","v4","randomItem","Math","floor","random","length","ItemModel","name","frame","getRandonValues","WeaponTypes","MELEE"],"sources":["../../../src/game_manager/controllers/ItemController.js"],"sourcesContent":["import ChestModel from \"../../models/ChestModel\";\nimport ItemModel from \"../../models/ItemModel\";\nimport * as itemData from \"../../../public/assets/level/tools.json\";\nimport { v4 } from \"uuid\";\nimport { getRandonValues, randomNumber, WeaponTypes } from \"../utils\";\n\nexport default class ItemController {\n  constructor(io) {\n    this.chests = {};\n    this.items = {};\n    this.io = io;\n\n    this.itemDictionary = {\n      chest: this.createChest.bind(this),\n      item: this.createItem.bind(this),\n      \"\": this.drop.bind(this),\n    };\n  }\n\n  setupEventListeners(socket) {\n    socket.on(\"playerPickupItem\", (itemId, player) => {\n      console.log(\"playerPickupItem\")\n      if (this.items[itemId]) {\n        if (player.canPickupItem()) {\n          player.addItem(this.items[itemId]);\n          socket.emit(\"updateItems\", player);\n          socket.broadcast.emit(\"updatePlayersItems\", socket.id, player);\n          this.deleteItems(itemId);\n        }\n      }\n    });\n\n    socket.on(\"playerPickupChest\", (chestId, player) => {\n      if (this.chests[chestId]) {\n        const { gold } = this.chests[chestId];\n        player.updateGold(gold);\n        socket.emit(\"updateScore\", player.gold);\n        socket.broadcast.emit(\"updatePlayersScore\", socket.id, player.gold);\n        this.deleteChest(chestId);\n      }\n    });\n\n    // socket.on(\"pickUpChest\", (chestId, player) => {\n    //   if (this.chests[chestId]) {\n    //     const { gold } = this.chests[chestId];\n    //     // updating the players gold\n    //     player.updateGold(gold);\n    //     socket.emit(\"updateScore\", player.gold);\n    //     socket.broadcast.emit(\n    //       \"updatePlayersScore\",\n    //       socket.id,\n    //       player.gold\n    //     );\n    //   this.deleteChest(chestId);\n    //   }\n    // });\n\n    socket.on(\"dropItem\", (x, y, item) => {\n      this.itemDictionary[item](x, y);\n    });\n  }\n\n  addItems(itemId, item) {\n    this.items[itemId] = item;\n    console.log(this.items);\n    this.io.emit(\"itemSpawned\", item);\n  }\n\n  deleteItems(itemId) {\n    delete this.items[itemId];\n    this.io.emit(\"itemRemoved\", itemId);\n  }\n\n  addChest(chestId, chest) {\n    this.chests[chestId] = chest;\n    console.log(this.chests);\n    this.io.emit(\"chestSpawned\", chest);\n  }\n\n  deleteChest(chestId) {\n    this.io.emit(\"chestRemoved\", chestId);\n  }\n\n  drop(x, y) {}\n\n  createChest(x, y) {\n    const chest = new ChestModel(x, y, randomNumber(10, 20), `chest-${v4()}`);\n    this.addChest(chest.id, chest);\n  }\n\n  createItem(x, y) {\n    const randomItem =\n      itemData.items[Math.floor(Math.random() * itemData.items.length)];\n\n    const item = new ItemModel(\n      x,\n      y,\n      `item-${v4()}`,\n      randomItem.name,\n      randomItem.frame,\n      getRandonValues(),\n      getRandonValues(),\n      getRandonValues(),\n      WeaponTypes.MELEE,\n      \"Description\"\n    );\n\n    this.addItems(item.id, item);\n  }\n}\n"],"mappings":"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","ignoreList":[]}