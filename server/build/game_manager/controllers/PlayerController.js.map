{"version":3,"file":"PlayerController.js","names":["_jsonwebtoken","_interopRequireDefault","require","_UserModel","_PlayerModel","PlayerController","exports","io","_classCallCheck2","players","playerLocations","_createClass2","key","value","setupEventListeners","socket","_eventNewPlayer","_eventPlayerMovement","_eventPickupChest","_eventPickupItem","_eventPlayerDroppedItem","_eventPlayerEquipedItem","_eventPlayerUnequipedItem","_eventHealthPotion","_eventAttackedPlayer","_eventPlayerHit","_eventSendBuyItemMessage","_eventPlayerUpdateXp","_eventDisconnect","_eventSavePlayerData","_this","on","_asyncToGenerator2","_regenerator","mark","_callee","wrap","_callee$","_context","prev","next","id","items","equipedItems","UserModel","updateOne","username","playerName","$set","player","t0","console","log","stop","_this2","_ref2","_callee2","token","instanceId","decoded","_decoded$user","name","_id","playerSchema","_callee2$","_context2","jwt","verify","process","env","JWT_SECRET","user","findById","sent","_spawnPlayer","emit","broadcast","_x","_x2","_x3","apply","arguments","_this3","playerData","x","y","flipX","actionAActive","potionAActive","frame","currentDirection","_this4","chestId","_this5","levelUp","level","attack","defense","maxHealth","exp","maxExp","_this6","itemId","removeItem","_this7","canEquipItem","equipItem","_this8","canPickupItem","addItem","removeEquipedItem","_this9","playerId","health","potion","_this10","attackedPlayerId","gold","playerAttackValue","playerAttacked","updateGold","respawn","to","concat","updateHealth","_this11","monsterAttack","length","undefined","_this12","item","potions","price","parseInt","updateExp","_this13","_this14","PlayerModel"],"sources":["../../../src/game_manager/controllers/PlayerController.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\n\r\nimport UserModel from \"../../models/UserModel\";\r\nimport PlayerModel from \"../../models/PlayerModel\";\r\nexport default class PlayerController {\r\n  constructor(io) {\r\n    this.players = {};\r\n    this.playerLocations = [];\r\n    this.io = io;\r\n  }\r\n\r\n  setupEventListeners(socket) {\r\n    this._eventNewPlayer(socket);\r\n    this._eventPlayerMovement(socket);\r\n    this._eventPickupChest(socket);\r\n    this._eventPickupItem(socket);\r\n    this._eventPlayerDroppedItem(socket);\r\n    this._eventPlayerEquipedItem(socket);\r\n    this._eventPlayerUnequipedItem(socket);\r\n    this._eventHealthPotion(socket);\r\n    this._eventPickupItem(socket);\r\n    this._eventAttackedPlayer(socket);\r\n    this._eventPlayerHit(socket);\r\n    this._eventSendBuyItemMessage(socket);\r\n    this._eventPlayerUpdateXp(socket);\r\n    this._eventDisconnect(socket);\r\n  }\r\n\r\n  _eventSavePlayerData(socket) {\r\n    return socket.on(\"savePlayerData\", async () => {\r\n      try {\r\n        if (!this.players[socket.id].items) {\r\n          this.players[socket.id].items = null;\r\n        }\r\n\r\n        if (!this.players[socket.id].equipedItems) {\r\n          this.players[socket.id].equipedItems = null;\r\n        }\r\n\r\n        await UserModel.updateOne(\r\n          { username: this.players[socket.id].playerName },\r\n          {\r\n            $set: {\r\n              player: this.players[socket.id],\r\n            },\r\n          }\r\n        );\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  _eventNewPlayer(socket) {\r\n    socket.on(\"newPlayer\", async (token, key, instanceId) => {\r\n      console.log(\"Player newPlayer\");\r\n\r\n      try {\r\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n        const { name, _id } = decoded.user;\r\n\r\n        const playerSchema = await UserModel.findById(_id);\r\n\r\n        const player = this._spawnPlayer(\r\n          socket.id,\r\n          name,\r\n          key,\r\n          playerSchema.player\r\n        );\r\n\r\n        socket.emit(\"currentPlayers\", this.players, instanceId);\r\n\r\n        // inform the other players of the new player that joined\r\n        socket.broadcast.emit(\"spawnPlayer\", player);\r\n        socket.emit(\"updateItems\", player);\r\n        socket.broadcast.emit(\"updatePlayersItems\", socket.id, player);\r\n      } catch (error) {\r\n        console.log(error);\r\n        socket.emit(\"invalidToken\");\r\n      }\r\n    });\r\n  }\r\n\r\n  _eventPlayerMovement(socket) {\r\n    return socket.on(\"playerMovement\", (playerData) => {\r\n      if (this.players[socket.id]) {\r\n        this.players[socket.id].x = playerData.x;\r\n        this.players[socket.id].y = playerData.y;\r\n        this.players[socket.id].flipX = playerData.flipX;\r\n        this.players[socket.id].actionAActive = playerData.actionAActive;\r\n        this.players[socket.id].potionAActive = playerData.potionAActive;\r\n        this.players[socket.id].frame = playerData.frame;\r\n        this.players[socket.id].currentDirection = playerData.currentDirection;\r\n        // emit a message to all players about the player that moved\r\n        this.io.emit(\"playerMoved\", this.players[socket.id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  _eventPickupChest(socket) {\r\n    return socket.on(\"pickUpChest\", (chestId) => {\r\n      this.io.emit(\"playerPickupChest\", chestId, this.players[socket.id]);\r\n    });\r\n  }\r\n\r\n  _eventPickupItem(socket) {\r\n    return socket.on(\"pickUpItem\", (itemId) => {\r\n      this.io.emit(\"playerPickupItem\", itemId, this.players[socket.id]);\r\n    });\r\n  }\r\n\r\n  _eventPlayerDroppedItem(socket) {\r\n    return socket.on(\"playerDroppedItem\", (itemId) => {\r\n      this.players[socket.id].removeItem(itemId);\r\n      socket.emit(\"updateItems\", this.players[socket.id]);\r\n      socket.broadcast.emit(\r\n        \"updatePlayersItems\",\r\n        socket.id,\r\n        this.players[socket.id]\r\n      );\r\n    });\r\n  }\r\n\r\n  _eventPlayerEquipedItem(socket) {\r\n    return socket.on(\"playerEquipedItem\", (itemId) => {\r\n      if (this.players[socket.id].items[itemId]) {\r\n        if (this.players[socket.id].canEquipItem()) {\r\n          this.players[socket.id].equipItem(\r\n            this.players[socket.id].items[itemId]\r\n          );\r\n          socket.emit(\"updateItems\", this.players[socket.id]);\r\n          socket.broadcast.emit(\r\n            \"updatePlayersItems\",\r\n            socket.id,\r\n            this.players[socket.id]\r\n          );\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _eventPlayerUnequipedItem(socket) {\r\n    return socket.on(\"playerUnequipedItem\", (itemId) => {\r\n      if (this.players[socket.id].equipedItems[itemId]) {\r\n        if (this.players[socket.id].canPickupItem()) {\r\n          this.players[socket.id].addItem(\r\n            this.players[socket.id].equipedItems[itemId]\r\n          );\r\n          this.players[socket.id].removeEquipedItem(itemId);\r\n          socket.emit(\"updateItems\", this.players[socket.id]);\r\n          socket.broadcast.emit(\r\n            \"updatePlayersItems\",\r\n            socket.id,\r\n            this.players[socket.id]\r\n          );\r\n        }\r\n      }\r\n    });\r\n  }\r\n  _eventPickupItem(socket) {\r\n    return socket.on(\"levelUp\", () => {\r\n      this.players[socket.id].levelUp();\r\n      this.io.emit(\r\n        \"updatePlayerStats\",\r\n        socket.id,\r\n        this.players[socket.id].level,\r\n        this.players[socket.id].attack,\r\n        this.players[socket.id].defense,\r\n        this.players[socket.id].maxHealth,\r\n        this.players[socket.id].exp,\r\n        this.players[socket.id].maxExp\r\n      );\r\n    });\r\n  }\r\n\r\n  _eventHealthPotion(socket) {\r\n    return socket.on(\"healthPotion\", (playerId, health) => {\r\n      this.players[playerId];\r\n      this.players[playerId].potion(health);\r\n      this.io.emit(\r\n        \"updatePlayerHealth\",\r\n        playerId,\r\n        this.players[playerId].health\r\n      );\r\n    });\r\n  }\r\n\r\n  _eventAttackedPlayer(socket) {\r\n    return socket.on(\"attackedPlayer\", (attackedPlayerId) => {\r\n      if (this.players[attackedPlayerId]) {\r\n        // get required info from attacked player\r\n        const { gold } = this.players[attackedPlayerId];\r\n        const playerAttackValue = this.players[socket.id].attack;\r\n\r\n        // subtract health from attacked player\r\n        this.players[attackedPlayerId].playerAttacked(playerAttackValue);\r\n\r\n        // check attacked players health, if dead send gold to other player\r\n        if (this.players[attackedPlayerId].health <= 0) {\r\n          // get the amount of gold, and update player object\r\n          this.players[socket.id].updateGold(gold);\r\n\r\n          // respawn attacked player\r\n          this.players[attackedPlayerId].respawn(this.players);\r\n          this.io.emit(\"respawnPlayer\", this.players[attackedPlayerId]);\r\n\r\n          // send update gold message to player\r\n          socket.emit(\"updateScore\", this.players[socket.id].gold);\r\n\r\n          // reset the attacked players gold\r\n          this.players[attackedPlayerId].updateGold(-gold);\r\n          this.io\r\n            .to(`${attackedPlayerId}`)\r\n            .emit(\"updateScore\", this.players[attackedPlayerId].gold);\r\n\r\n          // add bonus health to the player\r\n          this.players[socket.id].updateHealth(15);\r\n          this.io.emit(\r\n            \"updatePlayerHealth\",\r\n            socket.id,\r\n            this.players[socket.id].health\r\n          );\r\n        } else {\r\n          this.io.emit(\r\n            \"updatePlayerHealth\",\r\n            attackedPlayerId,\r\n            this.players[attackedPlayerId].health\r\n          );\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _eventPlayerHit(socket) {\r\n    return socket.on(\"playerHit\", (playerId, monsterAttack) => {\r\n      this.players[playerId].playerAttacked(monsterAttack);\r\n      this.io.emit(\r\n        \"updatePlayerHealth\",\r\n        playerId,\r\n        this.players[playerId].health\r\n      );\r\n    });\r\n  }\r\n\r\n  _eventSendBuyItemMessage(socket) {\r\n    return socket.on(\"sendBuyItemMessage\", (item) => {\r\n      this.players[socket.id].potions++;\r\n\r\n      this.players[socket.id].updateGold(-item.price);\r\n      socket.emit(\"updateScore\", this.players[socket.id].gold);\r\n      socket.broadcast.emit(\r\n        \"updatePlayersScore\",\r\n        socket.id,\r\n        this.players[socket.id].gold\r\n      );\r\n      // check the player's health, if below 0 have the player respawn\r\n      if (this.players[playerId].health <= 0) {\r\n        // update the gold the player has\r\n        this.players[playerId].updateGold(\r\n          parseInt(-this.players[playerId].gold / 2, 10)\r\n        );\r\n        this.players[playerId].updateExp(\r\n          parseInt(-this.players[playerId].exp / 2, 10)\r\n        );\r\n        socket.emit(\"updateScore\", this.players[playerId].gold);\r\n\r\n        // respawn the player\r\n        this.players[playerId].respawn(this.players);\r\n        this.io.emit(\"respawnPlayer\", this.players[playerId]);\r\n      }\r\n    });\r\n  }\r\n\r\n  _eventPlayerUpdateXp(socket) {\r\n    return socket.on(\"playerUpdateXp\", (playerId, exp) => {\r\n      this.players[playerId].updateExp(exp);\r\n      this.io.emit(\"updateXp\", exp, socket.id);\r\n    });\r\n  }\r\n\r\n  _eventDisconnect(socket) {\r\n    return socket.on(\"disconnect\", () => {\r\n      // delete user data from server\r\n\r\n      console.log(\"Player Disconnect\");\r\n\r\n      delete this.players[socket.id];\r\n\r\n      // emit a message to all players to remove this player\r\n      this.io.emit(\"disconnected\", socket.id);\r\n    });\r\n  }\r\n\r\n  _eventPlayerHit(socket) {\r\n    return socket.on(\"playerHit\", (playerId, monsterAttack, gold = 20) => {\r\n      this.players[playerId].playerAttacked(monsterAttack);\r\n      // check attacked players health, if dead send gold to other player\r\n      if (this.players[playerId].health <= 0) {\r\n        // get the amount of gold, and update player object\r\n        this.players[playerId].updateGold(gold);\r\n\r\n        // respawn attacked player\r\n        this.players[playerId].respawn(this.players);\r\n        this.io.emit(\"respawnPlayer\", this.players[playerId]);\r\n\r\n        // send update gold message to player\r\n        socket.emit(\"updateScore\", this.players[socket.id].gold);\r\n\r\n        // reset the attacked players gold\r\n        this.players[playerId].updateGold(-gold);\r\n        this.io\r\n          .to(`${playerId}`)\r\n          .emit(\"updateScore\", this.players[playerId].gold);\r\n\r\n        // add bonus health to the player\r\n        this.players[socket.id].updateHealth(15);\r\n        this.io.emit(\r\n          \"updatePlayerHealth\",\r\n          socket.id,\r\n          this.players[socket.id].health\r\n        );\r\n      } else {\r\n        this.io.emit(\r\n          \"updatePlayerHealth\",\r\n          playerId,\r\n          this.players[playerId].health\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  _spawnPlayer(playerId, name, key, playerSchema) {\r\n    const player = new PlayerModel(\r\n      playerId,\r\n      [\r\n        [200, 200],\r\n        [400, 400],\r\n      ],\r\n      this.players,\r\n      name,\r\n      key,\r\n      undefined,\r\n      playerSchema\r\n    );\r\n    this.players[playerId] = player;\r\n    return this.players[playerId];\r\n  }\r\n}\r\n"],"mappings":"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"}