{"version":3,"file":"PlayerController.js","names":["_jsonwebtoken","_interopRequireDefault","require","_UserModel","_PlayerModel","PlayerController","exports","io","playerLocations","_classCallCheck2","players","_createClass2","key","value","setupEventListeners","socket","_this","_eventNewPlayer","_eventPlayerMovement","_eventPickupChest","_eventPickupItem","_eventPlayerDroppedItem","_eventPlayerEquipedItem","_eventPlayerUnequipedItem","_eventHealthPotion","_eventAttackedPlayer","_eventPlayerHit","_eventSendBuyItemMessage","_eventPlayerUpdateXp","_eventLevelUp","_eventDisconnect","_eventSavePlayerData","on","item","playerId","player","addItem","emit","broadcast","_this2","_asyncToGenerator2","_regenerator","mark","_callee","wrap","_callee$","_context","prev","next","id","items","equipedItems","UserModel","updateOne","username","playerName","$set","t0","console","log","stop","_this3","_ref2","_callee2","token","instanceId","decoded","_decoded$user","name","_id","playerSchema","_callee2$","_context2","jwt","verify","process","env","JWT_SECRET","user","findById","sent","_spawnPlayer","_x","_x2","_x3","apply","arguments","_this4","playerData","x","y","flipX","actionAActive","potionAActive","frame","currentDirection","_this5","chestId","updateGold","gold","_this6","itemId","canPickupItem","_this7","removeItem","_this8","canEquipItem","equipItem","_this9","removeEquipedItem","_this10","levelUp","level","attack","defense","maxHealth","exp","maxExp","_this11","health","potion","_this12","attackedPlayerId","playerAttackValue","playerAttacked","respawn","to","concat","updateHealth","_this13","monsterAttack","parseInt","_this14","potions","price","_this15","updateExp","_this16","PlayerModel","undefined"],"sources":["../../../src/game_manager/controllers/PlayerController.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\n\nimport UserModel from \"../../models/UserModel.js\";\nimport PlayerModel from \"../../models/PlayerModel.js\";\nexport default class PlayerController {\n  constructor(io, playerLocations) {\n    this.players = {};\n    this.playerLocations = playerLocations;\n    this.io = io;\n  }\n\n  setupEventListeners(socket) {\n    this._eventNewPlayer(socket);\n    this._eventPlayerMovement(socket);\n    this._eventPickupChest(socket);\n    this._eventPickupItem(socket);\n    this._eventPlayerDroppedItem(socket);\n    this._eventPlayerEquipedItem(socket);\n    this._eventPlayerUnequipedItem(socket);\n    this._eventHealthPotion(socket);\n    this._eventAttackedPlayer(socket);\n    this._eventPlayerHit(socket);\n    this._eventSendBuyItemMessage(socket);\n    this._eventPlayerUpdateXp(socket);\n    this._eventLevelUp(socket);\n    this._eventDisconnect(socket);\n    this._eventSavePlayerData(socket);\n\n    socket.on(\"playerGetItem\", (item, playerId) => {\n      const player = this.players[playerId];\n      player.addItem(item);\n      socket.emit(\"updateItems\", player);\n      socket.broadcast.emit(\"updatePlayersItems\", playerId, player);\n    });\n  }\n\n  _eventSavePlayerData(socket) {\n    return socket.on(\"savePlayerData\", async () => {\n      try {\n        if (!this.players[socket.id].items) {\n          this.players[socket.id].items = null;\n        }\n\n        if (!this.players[socket.id].equipedItems) {\n          this.players[socket.id].equipedItems = null;\n        }\n\n        await UserModel.updateOne(\n          { username: this.players[socket.id].playerName },\n          {\n            $set: {\n              player: this.players[socket.id],\n            },\n          }\n        );\n      } catch (error) {\n        console.log(error);\n      }\n    });\n  }\n\n  _eventNewPlayer(socket) {\n    return socket.on(\"newPlayer\", async (token, key, instanceId) => {\n      try {\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\n        const { name, _id } = decoded.user;\n\n        const playerSchema = await UserModel.findById(_id);\n        console.log(name);\n        const player = this._spawnPlayer(\n          socket.id,\n          name,\n          key,\n          playerSchema.player\n        );\n\n        socket.emit(\"currentPlayers\", this.players, instanceId);\n\n        // inform the other players of the new player that joined\n        socket.broadcast.emit(\"spawnPlayer\", player);\n        socket.emit(\"updateItems\", player);\n        socket.broadcast.emit(\"updatePlayersItems\", socket.id, player);\n      } catch (error) {\n        console.log(error);\n        socket.emit(\"invalidToken\");\n      }\n    });\n  }\n\n  _eventPlayerMovement(socket) {\n    return socket.on(\"playerMovement\", (playerData) => {\n      if (this.players[socket.id]) {\n        this.players[socket.id].x = playerData.x;\n        this.players[socket.id].y = playerData.y;\n        this.players[socket.id].flipX = playerData.flipX;\n        this.players[socket.id].actionAActive = playerData.actionAActive;\n        this.players[socket.id].potionAActive = playerData.potionAActive;\n        this.players[socket.id].frame = playerData.frame;\n        this.players[socket.id].currentDirection = playerData.currentDirection;\n        // emit a message to all players about the player that moved\n        this.io.emit(\"playerMoved\", this.players[socket.id]);\n      }\n    });\n  }\n\n  _eventPickupChest(socket) {\n    return socket.on(\"pickUpChest\", (chestId) => {\n      const player = this.players[socket.id];\n      player.updateGold(20);\n      socket.emit(\"updateScore\", player.gold);\n      socket.broadcast.emit(\"updatePlayersScore\", socket.id, player.gold);\n      this.io.emit(\"chestRemoved\", chestId);\n    });\n  }\n\n  _eventPickupItem(socket) {\n    return socket.on(\"pickUpItem\", (itemId) => {\n      const player = this.players[socket.id];\n      if (player.canPickupItem()) {\n        socket.emit(\"collectItem\", itemId);\n      }\n    });\n  }\n\n  _eventPlayerDroppedItem(socket) {\n    return socket.on(\"playerDroppedItem\", (itemId) => {\n      this.players[socket.id].removeItem(itemId);\n      socket.emit(\"updateItems\", this.players[socket.id]);\n      socket.broadcast.emit(\n        \"updatePlayersItems\",\n        socket.id,\n        this.players[socket.id]\n      );\n    });\n  }\n\n  _eventPlayerEquipedItem(socket) {\n    return socket.on(\"playerEquipedItem\", (itemId) => {\n      if (this.players[socket.id].items[itemId]) {\n        if (this.players[socket.id].canEquipItem()) {\n          this.players[socket.id].equipItem(\n            this.players[socket.id].items[itemId]\n          );\n          socket.emit(\"updateItems\", this.players[socket.id]);\n          socket.broadcast.emit(\n            \"updatePlayersItems\",\n            socket.id,\n            this.players[socket.id]\n          );\n        }\n      }\n    });\n  }\n\n  _eventPlayerUnequipedItem(socket) {\n    return socket.on(\"playerUnequipedItem\", (itemId) => {\n      if (this.players[socket.id].equipedItems[itemId]) {\n        if (this.players[socket.id].canPickupItem()) {\n          this.players[socket.id].addItem(\n            this.players[socket.id].equipedItems[itemId]\n          );\n          this.players[socket.id].removeEquipedItem(itemId);\n          socket.emit(\"updateItems\", this.players[socket.id]);\n          socket.broadcast.emit(\n            \"updatePlayersItems\",\n            socket.id,\n            this.players[socket.id]\n          );\n        }\n      }\n    });\n  }\n  _eventLevelUp(socket) {\n    return socket.on(\"levelUp\", () => {\n      this.players[socket.id].levelUp();\n      this.io.emit(\n        \"updatePlayerStats\",\n        socket.id,\n        this.players[socket.id].level,\n        this.players[socket.id].attack,\n        this.players[socket.id].defense,\n        this.players[socket.id].maxHealth,\n        this.players[socket.id].exp,\n        this.players[socket.id].maxExp\n      );\n    });\n  }\n\n  _eventHealthPotion(socket) {\n    return socket.on(\"healthPotion\", (playerId, health) => {\n      this.players[playerId];\n      this.players[playerId].potion(health);\n      this.io.emit(\n        \"updatePlayerHealth\",\n        playerId,\n        this.players[playerId].health\n      );\n    });\n  }\n\n  _eventAttackedPlayer(socket) {\n    return socket.on(\"attackedPlayer\", (attackedPlayerId) => {\n      if (this.players[attackedPlayerId]) {\n        // get required info from attacked player\n        const { gold } = this.players[attackedPlayerId];\n        const playerAttackValue = this.players[socket.id].attack;\n\n        // subtract health from attacked player\n        this.players[attackedPlayerId].playerAttacked(playerAttackValue);\n\n        // check attacked players health, if dead send gold to other player\n        if (this.players[attackedPlayerId].health <= 0) {\n          // get the amount of gold, and update player object\n          this.players[socket.id].updateGold(gold);\n\n          // respawn attacked player\n          this.players[attackedPlayerId].respawn(this.players);\n          this.io.emit(\"respawnPlayer\", this.players[attackedPlayerId]);\n\n          // send update gold message to player\n          socket.emit(\"updateScore\", this.players[socket.id].gold);\n\n          // reset the attacked players gold\n          this.players[attackedPlayerId].updateGold(-gold);\n          this.io\n            .to(`${attackedPlayerId}`)\n            .emit(\"updateScore\", this.players[attackedPlayerId].gold);\n\n          // add bonus health to the player\n          this.players[socket.id].updateHealth(15);\n          this.io.emit(\n            \"updatePlayerHealth\",\n            socket.id,\n            this.players[socket.id].health\n          );\n        } else {\n          this.io.emit(\n            \"updatePlayerHealth\",\n            attackedPlayerId,\n            this.players[attackedPlayerId].health\n          );\n        }\n      }\n    });\n  }\n\n  _eventPlayerHit(socket) {\n    return socket.on(\"playerHit\", (playerId, monsterAttack) => {\n      this.players[playerId].playerAttacked(monsterAttack);\n      this.io.emit(\n        \"updatePlayerHealth\",\n        playerId,\n        this.players[playerId].health\n      );\n      // check the player's health, if below 0 have the player respawn\n      if (this.players[playerId].health <= 0) {\n        // update the gold the player has\n        this.players[playerId].updateGold(\n          parseInt(-this.players[playerId].gold / 2, 10)\n        );\n        socket.emit(\"updateScore\", this.players[playerId].gold);\n\n        // respawn the player\n        this.players[playerId].respawn(this.players);\n        this.io.emit(\"respawnPlayer\", this.players[playerId]);\n      }\n    });\n  }\n\n  _eventSendBuyItemMessage(socket) {\n    return socket.on(\"sendBuyItemMessage\", (item) => {\n      this.players[socket.id].potions++;\n\n      this.players[socket.id].updateGold(-item.price);\n      socket.emit(\"updateScore\", this.players[socket.id].gold);\n      socket.broadcast.emit(\n        \"updatePlayersScore\",\n        socket.id,\n        this.players[socket.id].gold\n      );\n    });\n  }\n\n  _eventPlayerUpdateXp(socket) {\n    return socket.on(\"playerUpdateXp\", (playerId, exp) => {\n      this.players[playerId].updateExp(exp);\n      this.io.emit(\"updateXp\", exp, socket.id);\n    });\n  }\n\n  _eventDisconnect(socket) {\n    return socket.on(\"disconnect\", () => {\n      // delete user data from server\n\n      console.log(\"Player Disconnect\");\n\n      delete this.players[socket.id];\n\n      // emit a message to all players to remove this player\n      this.io.emit(\"disconnected\", socket.id);\n    });\n  }\n\n  _spawnPlayer(playerId, name, key, playerSchema) {\n    const player = new PlayerModel(\n      playerId,\n      [\n        [200, 200],\n        [400, 400],\n      ],\n      this.players,\n      name,\n      key,\n      undefined,\n      playerSchema\n    );\n    this.players[playerId] = player;\n    return this.players[playerId];\n  }\n}\n"],"mappings":"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","ignoreList":[]}