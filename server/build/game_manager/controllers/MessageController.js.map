{"version":3,"sources":["../../../src/game_manager/controllers/MessageController.js"],"names":["MessageController","io","socket","_sendMessage","on","message","token","player","decoded","jwt","verify","process","env","JWT_SECRET","email","user","ChatModel","create","emit","name","playerName","console","log"],"mappings":";;;;;;;;;;;;;;;;;IAAqBA,iB;AACnB,6BAAYC,EAAZ,EAAgB;AAAA;AACd,SAAKA,EAAL,GAAUA,EAAV;AACD;;;;WAED,6BAAoBC,MAApB,EAA4B;AAC1B,WAAKC,YAAL,CAAkBD,MAAlB;AACD;;;WAED,sBAAaA,MAAb,EAAqB;AAAA;;AACnBA,MAAAA,MAAM,CAACE,EAAP,CAAU,aAAV;AAAA,iGAAyB,iBAAOC,OAAP,EAAgBC,KAAhB,EAAuBC,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEfC,kBAAAA,OAFe,GAELC,GAAG,CAACC,MAAJ,CAAWJ,KAAX,EAAkBK,OAAO,CAACC,GAAR,CAAYC,UAA9B,CAFK;AAGbC,kBAAAA,KAHa,GAGHN,OAAO,CAACO,IAHL,CAGbD,KAHa;AAAA;AAAA,yBAIfE,SAAS,CAACC,MAAV,CAAiB;AAAEH,oBAAAA,KAAK,EAALA,KAAF;AAAST,oBAAAA,OAAO,EAAPA;AAAT,mBAAjB,CAJe;;AAAA;AAKrB,kBAAA,KAAI,CAACJ,EAAL,CAAQiB,IAAR,CAAa,YAAb,EAA2B;AACzBb,oBAAAA,OAAO,EAAPA,OADyB;AAEzBc,oBAAAA,IAAI,EAAEZ,MAAM,CAACa;AAFY,mBAA3B;;AALqB;AAAA;;AAAA;AAAA;AAAA;AAUrBC,kBAAAA,OAAO,CAACC,GAAR;;AAVqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAzB;;AAAA;AAAA;AAAA;AAAA;AAaD","sourcesContent":["export default class MessageController {\r\n  constructor(io) {\r\n    this.io = io;\r\n  }\r\n\r\n  setupEventListeners(socket) {\r\n    this._sendMessage(socket);\r\n  }\r\n\r\n  _sendMessage(socket) {\r\n    socket.on(\"sendMessage\", async (message, token, player) => {\r\n      try {\r\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n        const { email } = decoded.user;\r\n        await ChatModel.create({ email, message });\r\n        this.io.emit(\"newMessage\", {\r\n          message,\r\n          name: player.playerName,\r\n        });\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"file":"MessageController.js"}