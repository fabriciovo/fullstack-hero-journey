{"version":3,"file":"MessageController.js","names":["MessageController","exports","io","_classCallCheck2","_createClass2","key","value","setupEventListeners","socket","_sendMessage","_this","on","_ref","_asyncToGenerator2","_regenerator","mark","_callee","message","token","player","decoded","email","wrap","_callee$","_context","prev","next","jwt","verify","process","env","JWT_SECRET","user","ChatModel","create","emit","name","playerName","t0","console","log","stop","_x","_x2","_x3","apply","arguments"],"sources":["../../../src/game_manager/controllers/MessageController.js"],"sourcesContent":["export default class MessageController {\r\n  constructor(io) {\r\n    this.io = io;\r\n  }\r\n\r\n  setupEventListeners(socket) {\r\n    this._sendMessage(socket);\r\n  }\r\n\r\n  _sendMessage(socket) {\r\n    socket.on(\"sendMessage\", async (message, token, player) => {\r\n      try {\r\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n        const { email } = decoded.user;\r\n        await ChatModel.create({ email, message });\r\n        this.io.emit(\"newMessage\", {\r\n          message,\r\n          name: player.playerName,\r\n        });\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;IAAqBA,iBAAiB,GAAAC,OAAA;EACpC,SAAAD,kBAAYE,EAAE,EAAE;IAAA,IAAAC,gBAAA,mBAAAH,iBAAA;IACd,IAAI,CAACE,EAAE,GAAGA,EAAE;EACd;EAAC,IAAAE,aAAA,aAAAJ,iBAAA;IAAAK,GAAA;IAAAC,KAAA,EAED,SAAAC,oBAAoBC,MAAM,EAAE;MAC1B,IAAI,CAACC,YAAY,CAACD,MAAM,CAAC;IAC3B;EAAC;IAAAH,GAAA;IAAAC,KAAA,EAED,SAAAG,aAAaD,MAAM,EAAE;MAAA,IAAAE,KAAA;MACnBF,MAAM,CAACG,EAAE,CAAC,aAAa;QAAA,IAAAC,IAAA,OAAAC,kBAAA,2BAAAC,YAAA,YAAAC,IAAA,CAAE,SAAAC,QAAOC,OAAO,EAAEC,KAAK,EAAEC,MAAM;UAAA,IAAAC,OAAA,EAAAC,KAAA;UAAA,OAAAP,YAAA,YAAAQ,IAAA,UAAAC,SAAAC,QAAA;YAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cAAA;gBAAAF,QAAA,CAAAC,IAAA;gBAE5CL,OAAO,GAAGO,GAAG,CAACC,MAAM,CAACV,KAAK,EAAEW,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;gBACjDV,KAAK,GAAKD,OAAO,CAACY,IAAI,CAAtBX,KAAK;gBAAAG,QAAA,CAAAE,IAAA;gBAAA,OACPO,SAAS,CAACC,MAAM,CAAC;kBAAEb,KAAK,EAALA,KAAK;kBAAEJ,OAAO,EAAPA;gBAAQ,CAAC,CAAC;cAAA;gBAC1CP,KAAI,CAACR,EAAE,CAACiC,IAAI,CAAC,YAAY,EAAE;kBACzBlB,OAAO,EAAPA,OAAO;kBACPmB,IAAI,EAAEjB,MAAM,CAACkB;gBACf,CAAC,CAAC;gBAACb,QAAA,CAAAE,IAAA;gBAAA;cAAA;gBAAAF,QAAA,CAAAC,IAAA;gBAAAD,QAAA,CAAAc,EAAA,GAAAd,QAAA;gBAEHe,OAAO,CAACC,GAAG,CAAAhB,QAAA,CAAAc,EAAM,CAAC;cAAC;cAAA;gBAAA,OAAAd,QAAA,CAAAiB,IAAA;YAAA;UAAA,GAAAzB,OAAA;QAAA,CAEtB;QAAA,iBAAA0B,EAAA,EAAAC,GAAA,EAAAC,GAAA;UAAA,OAAAhC,IAAA,CAAAiC,KAAA,OAAAC,SAAA;QAAA;MAAA,IAAC;IACJ;EAAC;EAAA,OAAA9C,iBAAA;AAAA"}