{"version":3,"file":"MessageController.js","names":["_jsonwebtoken","_interopRequireDefault","require","_ChatModel","MessageController","exports","io","_classCallCheck2","_createClass2","key","value","setupEventListeners","socket","_sendMessage","_this","on","_ref","_asyncToGenerator2","_regenerator","mark","_callee","message","token","player","decoded","_decoded$user","email","playerName","wrap","_callee$","_context","prev","next","jwt","verify","process","env","JWT_SECRET","user","console","log","ChatModel","create","emit","name","t0","stop","_x","_x2","_x3","apply","arguments"],"sources":["../../../src/game_manager/controllers/MessageController.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\n\nimport ChatModel from \"../../models/ChatModel\";\nexport default class MessageController {\n  constructor(io) {\n    this.io = io;\n  }\n\n  setupEventListeners(socket) {\n    this._sendMessage(socket);\n  }\n\n  _sendMessage(socket) {\n    socket.on(\"sendMessage\", async (message, token, player) => {\n      try {\n        const decoded = jwt.verify(token, process.env.JWT_SECRET);\n        const { email, playerName } = decoded.user;\n        console.log( decoded.user)\n        await ChatModel.create({ email, message });\n        this.io.emit(\"newMessage\", {\n          message,\n          name: playerName,\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    });\n  }\n}\n"],"mappings":";;;;;;;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA+C,IAC1BE,iBAAiB,GAAAC,OAAA;EACpC,SAAAD,kBAAYE,EAAE,EAAE;IAAA,IAAAC,gBAAA,mBAAAH,iBAAA;IACd,IAAI,CAACE,EAAE,GAAGA,EAAE;EACd;EAAC,WAAAE,aAAA,aAAAJ,iBAAA;IAAAK,GAAA;IAAAC,KAAA,EAED,SAAAC,oBAAoBC,MAAM,EAAE;MAC1B,IAAI,CAACC,YAAY,CAACD,MAAM,CAAC;IAC3B;EAAC;IAAAH,GAAA;IAAAC,KAAA,EAED,SAAAG,aAAaD,MAAM,EAAE;MAAA,IAAAE,KAAA;MACnBF,MAAM,CAACG,EAAE,CAAC,aAAa;QAAA,IAAAC,IAAA,OAAAC,kBAAA,2BAAAC,YAAA,YAAAC,IAAA,CAAE,SAAAC,QAAOC,OAAO,EAAEC,KAAK,EAAEC,MAAM;UAAA,IAAAC,OAAA,EAAAC,aAAA,EAAAC,KAAA,EAAAC,UAAA;UAAA,OAAAT,YAAA,YAAAU,IAAA,UAAAC,SAAAC,QAAA;YAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cAAA;gBAAAF,QAAA,CAAAC,IAAA;gBAE5CP,OAAO,GAAGS,wBAAG,CAACC,MAAM,CAACZ,KAAK,EAAEa,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;gBAAAZ,aAAA,GAC3BD,OAAO,CAACc,IAAI,EAAlCZ,KAAK,GAAAD,aAAA,CAALC,KAAK,EAAEC,UAAU,GAAAF,aAAA,CAAVE,UAAU;gBACzBY,OAAO,CAACC,GAAG,CAAEhB,OAAO,CAACc,IAAI,CAAC;gBAAAR,QAAA,CAAAE,IAAA;gBAAA,OACpBS,qBAAS,CAACC,MAAM,CAAC;kBAAEhB,KAAK,EAALA,KAAK;kBAAEL,OAAO,EAAPA;gBAAQ,CAAC,CAAC;cAAA;gBAC1CP,KAAI,CAACR,EAAE,CAACqC,IAAI,CAAC,YAAY,EAAE;kBACzBtB,OAAO,EAAPA,OAAO;kBACPuB,IAAI,EAAEjB;gBACR,CAAC,CAAC;gBAACG,QAAA,CAAAE,IAAA;gBAAA;cAAA;gBAAAF,QAAA,CAAAC,IAAA;gBAAAD,QAAA,CAAAe,EAAA,GAAAf,QAAA;gBAEHS,OAAO,CAACC,GAAG,CAAAV,QAAA,CAAAe,EAAM,CAAC;cAAC;cAAA;gBAAA,OAAAf,QAAA,CAAAgB,IAAA;YAAA;UAAA,GAAA1B,OAAA;QAAA,CAEtB;QAAA,iBAAA2B,EAAA,EAAAC,GAAA,EAAAC,GAAA;UAAA,OAAAjC,IAAA,CAAAkC,KAAA,OAAAC,SAAA;QAAA;MAAA,IAAC;IACJ;EAAC;AAAA","ignoreList":[]}