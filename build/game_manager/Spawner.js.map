{"version":3,"sources":["../../src/game_manager/Spawner.js"],"names":["getRandonValues","bonus","Math","floor","random","length","Spawner","config","spawnLocations","addObject","deleteObject","moveObjects","id","spawnInterval","limit","objectType","spawnerType","objectsCreated","start","interval","setInterval","spawnObject","SpawnerType","MONSTER","moveMonsters","CHEST","spawnChest","spawnMonster","ITEM","spawnItem","location","pickRandomLocation","randomItem","itemData","items","item","ItemModel","name","frame","WeaponTypes","MELEE","push","chest","ChestModel","monster","MonsterModel","invalidLocation","some","obj","x","y","filter","moveMonsterInterval","forEach","move"],"mappings":"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","sourcesContent":["import { SpawnerType, randomNumber, WeaponTypes } from \"./utils\";\r\nimport ChestModel from \"./ChestModel\";\r\nimport MonsterModel from \"./MonsterModel\";\r\nimport ItemModel from \"../models/ItemModel\";\r\n\r\nimport * as itemData from \"../../public/assets/level/tools.json\";\r\n\r\nfunction getRandonValues() {\r\n  const bonus = [-2, -10, -3, -5, -6, -7, 0, 5, 3, 4, 7, 2, 1, 8, 10];\r\n  return bonus[Math.floor(Math.random() * bonus.length)];\r\n}\r\n\r\nexport default class Spawner {\r\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\r\n    this.id = config.id;\r\n    this.spawnInterval = config.spawnInterval;\r\n    this.limit = config.limit;\r\n    this.objectType = config.spawnerType;\r\n    this.spawnLocations = spawnLocations;\r\n    this.addObject = addObject;\r\n    this.deleteObject = deleteObject;\r\n    this.moveObjects = moveObjects;\r\n\r\n    this.objectsCreated = [];\r\n\r\n    this.start();\r\n  }\r\n\r\n  start() {\r\n    this.interval = setInterval(() => {\r\n      if (this.objectsCreated.length < this.limit) {\r\n        this.spawnObject();\r\n      }\r\n    }, this.spawnInterval);\r\n    if (this.objectType === SpawnerType.MONSTER) this.moveMonsters();\r\n  }\r\n\r\n  spawnObject() {\r\n    if (this.objectType === SpawnerType.CHEST) {\r\n      this.spawnChest();\r\n    } else if (this.objectType === SpawnerType.MONSTER) {\r\n      this.spawnMonster();\r\n    } else if (this.objectType === SpawnerType.ITEM) {\r\n      this.spawnItem();\r\n    }\r\n  }\r\n\r\n  spawnItem() {\r\n    const location = this.pickRandomLocation();\r\n\r\n    const randomItem =\r\n      itemData.items[Math.floor(Math.random() * itemData.items.length)];\r\n\r\n    const item = new ItemModel(\r\n      location[0],\r\n      location[1],\r\n      this.id,\r\n      randomItem.name,\r\n      randomItem.frame,\r\n      getRandonValues(),\r\n      getRandonValues(),\r\n      getRandonValues(),\r\n      WeaponTypes.MELEE,\r\n      \"Description\"\r\n    );\r\n    this.objectsCreated.push(item);\r\n    this.addObject(item.id, item);\r\n  }\r\n\r\n  spawnChest() {\r\n    const location = this.pickRandomLocation();\r\n    const chest = new ChestModel(\r\n      location[0],\r\n      location[1],\r\n      randomNumber(10, 20),\r\n      this.id\r\n    );\r\n    this.objectsCreated.push(chest);\r\n    this.addObject(chest.id, chest);\r\n  }\r\n\r\n  spawnMonster() {\r\n    const location = this.pickRandomLocation();\r\n    const monster = new MonsterModel(\r\n      location[0],\r\n      location[1],\r\n      randomNumber(10, 120),\r\n      this.id,\r\n      randomNumber(0, 20), // frame value\r\n      randomNumber(110, 320), // health value\r\n      randomNumber(30, 320), // attack value\r\n      randomNumber(10, 120) // exp value\r\n    );\r\n    this.objectsCreated.push(monster);\r\n    this.addObject(monster.id, monster);\r\n  }\r\n\r\n  pickRandomLocation() {\r\n    const location =\r\n      this.spawnLocations[\r\n        Math.floor(Math.random() * this.spawnLocations.length)\r\n      ];\r\n    const invalidLocation = this.objectsCreated.some((obj) => {\r\n      if (obj.x === location[0] && obj.y === location[1]) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n\r\n    if (invalidLocation) return this.pickRandomLocation();\r\n    return location;\r\n  }\r\n\r\n  removeObject(id) {\r\n    this.objectsCreated = this.objectsCreated.filter((obj) => obj.id !== id);\r\n    this.deleteObject(id);\r\n  }\r\n\r\n  moveMonsters() {\r\n    this.moveMonsterInterval = setInterval(() => {\r\n      this.objectsCreated.forEach((monster) => {\r\n        monster.move();\r\n      });\r\n\r\n      this.moveObjects();\r\n    }, 1000);\r\n  }\r\n}\r\n"],"file":"Spawner.js"}