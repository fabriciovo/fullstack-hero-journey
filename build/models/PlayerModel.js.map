{"version":3,"sources":["../../src/models/PlayerModel.js"],"names":["PlayerModel","playerId","spawnLocations","players","name","key","playerSchema","attack","defense","health","maxHealth","gold","id","playerName","items","equipedItems","level","exp","maxExp","potions","maxNumberOfItems","actionAActive","flipX","location","generateLocation","x","y","item","attackBonus","defenseBonus","healthBonus","removeItem","itemId","Object","keys","length","damage","updateHealth","calcNewExp","Math","floor","random","invalidLocation","some"],"mappings":"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","sourcesContent":["export default class PlayerModel {\r\n  constructor(playerId, spawnLocations, players, name, key, playerSchema) {\r\n    this.attack = playerSchema.attack;\r\n    this.defense = playerSchema.defense;\r\n    this.health = playerSchema.health;\r\n    this.maxHealth = playerSchema.maxHealth;\r\n    this.gold = playerSchema.gold;\r\n    this.id = playerId;\r\n    this.playerName = name;\r\n    this.key = key;\r\n    this.items = playerSchema.items || {};\r\n    this.equipedItems = playerSchema.equipedItems || {};\r\n    this.level = playerSchema.level;\r\n    this.exp = playerSchema.exp;\r\n    this.maxExp = playerSchema.maxExp;\r\n    this.potions = playerSchema.potions;\r\n    //this.playerItems =  {};\r\n\r\n    this.maxNumberOfItems = 5;\r\n\r\n    this.spawnLocations = spawnLocations;\r\n    this.actionAActive = false;\r\n    this.flipX = true;\r\n    const location = this.generateLocation(players);\r\n    this.x = location[0];\r\n    this.y = location[1];\r\n  }\r\n\r\n  addItem(item) {\r\n    this.items[item.id] = item;\r\n  }\r\n\r\n  equipItem(item) {\r\n    this.equipedItems[item.id] = item;\r\n\r\n    this.attack += this.equipedItems[item.id].attackBonus;\r\n    this.defense += this.equipedItems[item.id].defenseBonus;\r\n    this.maxHealth += this.equipedItems[item.id].healthBonus;\r\n    this.removeItem(item.id);\r\n  }\r\n\r\n  removeEquipedItem(itemId) {\r\n    this.attack -= this.equipedItems[itemId].attackBonus;\r\n    this.defense -= this.equipedItems[itemId].defenseBonus;\r\n    this.maxHealth -= this.equipedItems[itemId].healthBonus;\r\n    delete this.equipedItems[itemId];\r\n  }\r\n\r\n  removeItem(itemId) {\r\n    // this.attack -= this.items[itemId].attackBonus;\r\n    // this.defense -= this.items[itemId].defenseBonus;\r\n    // this.maxHealth -= this.items[itemId].healthBonus;\r\n    delete this.items[itemId];\r\n  }\r\n\r\n  canPickupItem() {\r\n    if (Object.keys(this.items).length < 5) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  canEquipItem() {\r\n    if (Object.keys(this.equipedItems).length < 5) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  playerAttacked(attack) {\r\n    let damage = this.defense - attack;\r\n    if (damage > 0) damage = 0;\r\n\r\n    this.updateHealth(damage);\r\n  }\r\n\r\n  updateGold(gold) {\r\n    this.gold += gold;\r\n  }\r\n  \r\n  potion(health){\r\n    this.updateHealth(health)\r\n    this.potions--;\r\n  }\r\n\r\n\r\n  updateExp(exp) {\r\n    this.exp += exp;\r\n  }\r\n\r\n  levelUp() {\r\n    this.attack += 3;\r\n    this.defense += 2;\r\n    this.maxHealth += 1;\r\n    this.level++;\r\n    const calcNewExp = this.exp - this.maxExp;\r\n    this.exp = calcNewExp;\r\n    this.maxExp = this.maxExp * 2;\r\n  }\r\n\r\n  updateHealth(health) {\r\n    this.health += health;\r\n    if (this.health > this.maxHealth) this.health = this.maxHealth;\r\n  }\r\n\r\n  respawn(players) {\r\n    this.health = this.maxHealth;\r\n    const location = this.generateLocation(players);\r\n    this.x = location[0];\r\n    this.y = location[1];\r\n  }\r\n\r\n  generateLocation(players) {\r\n    const location =\r\n      this.spawnLocations[\r\n        Math.floor(Math.random() * this.spawnLocations.length)\r\n      ];\r\n    const invalidLocation = Object.keys(players).some((key) => {\r\n      if (players[key].x === location[0] && players[key].y === location[1]) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    if (invalidLocation) {\r\n      return this.generateLocation(players);\r\n    } else {\r\n      return location;\r\n    }\r\n  }\r\n}\r\n"],"file":"PlayerModel.js"}