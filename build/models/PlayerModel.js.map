{"version":3,"sources":["../../src/models/PlayerModel.js"],"names":["PlayerModel","playerId","spawnLocations","players","name","frame","playerSchema","attack","defense","health","maxHealth","gold","id","playerName","items","equipedItems","level","exp","maxExp","maxNumberOfItems","actionAActive","flipX","location","generateLocation","x","y","item","attackBonus","defenseBonus","healthBonus","removeItem","itemId","Object","keys","length","damage","updateHealth","calcNewExp","Math","floor","random","invalidLocation","some","key"],"mappings":"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","sourcesContent":["export default class PlayerModel {\r\n  constructor(playerId, spawnLocations, players, name, frame, playerSchema) {\r\n    this.attack = playerSchema.attack;\r\n    this.defense = playerSchema.defense;\r\n    this.health = playerSchema.health;\r\n    this.maxHealth = playerSchema.maxHealth;\r\n    this.gold = playerSchema.gold;\r\n    this.id = playerId;\r\n    this.playerName = name;\r\n    this.frame = frame;\r\n    this.items = playerSchema.items || {};\r\n    this.equipedItems = playerSchema.equipedItems || {};\r\n    this.level = playerSchema.level;\r\n    this.exp = playerSchema.exp;\r\n    this.maxExp = playerSchema.maxExp;\r\n\r\n    //this.playerItems =  {};\r\n\r\n    this.maxNumberOfItems = 5;\r\n\r\n    this.spawnLocations = spawnLocations;\r\n    this.actionAActive = false;\r\n    this.flipX = true;\r\n    const location = this.generateLocation(players);\r\n    this.x = location[0];\r\n    this.y = location[1];\r\n  }\r\n\r\n  addItem(item) {\r\n    this.items[item.id] = item;\r\n  }\r\n\r\n  equipItem(item) {\r\n    this.equipedItems[item.id] = item;\r\n\r\n    this.attack += this.equipedItems[item.id].attackBonus;\r\n    this.defense += this.equipedItems[item.id].defenseBonus;\r\n    this.maxHealth += this.equipedItems[item.id].healthBonus;\r\n    this.removeItem(item.id);\r\n  }\r\n\r\n  removeEquipedItem(itemId) {\r\n    this.attack -= this.equipedItems[itemId].attackBonus;\r\n    this.defense -= this.equipedItems[itemId].defenseBonus;\r\n    this.maxHealth -= this.equipedItems[itemId].healthBonus;\r\n    delete this.equipedItems[itemId];\r\n  }\r\n\r\n  removeItem(itemId) {\r\n    // this.attack -= this.items[itemId].attackBonus;\r\n    // this.defense -= this.items[itemId].defenseBonus;\r\n    // this.maxHealth -= this.items[itemId].healthBonus;\r\n    delete this.items[itemId];\r\n  }\r\n\r\n  canPickupItem() {\r\n    if (Object.keys(this.items).length < 5) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  canEquipItem() {\r\n    if (Object.keys(this.equipedItems).length < 5) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  playerAttacked(attack) {\r\n    let damage = this.defense - attack;\r\n    if (damage > 0) damage = 0;\r\n\r\n    this.updateHealth(damage);\r\n  }\r\n\r\n  updateGold(gold) {\r\n    this.gold += gold;\r\n  }\r\n\r\n  updateExp(exp) {\r\n    this.exp += exp;\r\n  }\r\n\r\n  levelUp() {\r\n    this.attack += 3;\r\n    this.defense += 2;\r\n    this.maxHealth += 1;\r\n    this.level++;\r\n    const calcNewExp = this.exp - this.maxExp;\r\n    this.exp = calcNewExp;\r\n    this.maxExp = this.maxExp * 2;\r\n  }\r\n\r\n  updateHealth(health) {\r\n    this.health += health;\r\n    if (this.health > this.maxHealth) this.health = this.maxHealth;\r\n  }\r\n\r\n  respawn(players) {\r\n    this.health = this.maxHealth;\r\n    const location = this.generateLocation(players);\r\n    this.x = location[0];\r\n    this.y = location[1];\r\n  }\r\n\r\n  generateLocation(players) {\r\n    const location =\r\n      this.spawnLocations[\r\n        Math.floor(Math.random() * this.spawnLocations.length)\r\n      ];\r\n    const invalidLocation = Object.keys(players).some((key) => {\r\n      if (players[key].x === location[0] && players[key].y === location[1]) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    });\r\n\r\n    if (invalidLocation) {\r\n      return this.generateLocation(players);\r\n    } else {\r\n      return location;\r\n    }\r\n  }\r\n}\r\n"],"file":"PlayerModel.js"}